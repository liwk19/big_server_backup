Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.2.5, while the latest version is 1.3.3.
Namespace(seed=1, dataset='ogbn-mag', gpu=0, root='../data/', emb_path='../data/', stages=[400, 400, 400, 400], extra_embedding='complex', embed_size=256, num_hops=2, label_feats=True, num_label_hops=2, hidden=512, dropout=0.5, n_layers_1=2, n_layers_2=2, n_layers_3=4, input_drop=0.1, att_drop=0.0, label_drop=0.0, residual=True, act='leaky_relu', bns=True, label_bns=True, amp=True, lr=0.001, weight_decay=0.0, eval_every=1, batch_size=10000, patience=100, threshold=0.75, gama=10.0, start_stage=0, reload='', moving_k=1, store_model=False, moe_widget=['feat_ngnn', 'label_ngnn'], num_expert=8, top_k=1, expert_drop=0.0, gate='naive')
Use extra embeddings generated with the complex method
Current num hops = 2
./output/ogbn-mag/61c06570624a4fc4addb2e710afd7a75 

Stage 0 

Current num label hops = 2
# Params: 10476583
Epoch:20, avg epoch time:19.8866
 Train loss:1.6147763918316553, Val loss:1.6299586296081543, Test loss:1.6644779443740845
 Train acc:55.4096, Val acc:53.4765, Test acc:52.2473
Best Epoch 18,Val 53.5535, Test 52.2473

Epoch:40, avg epoch time:19.7257
 Train loss:1.4813026492557828, Val loss:1.5752768516540527, Test loss:1.6209815740585327
 Train acc:57.7897, Val acc:54.2101, Test acc:52.4881
Best Epoch 38,Val 54.3026, Test 52.8530

Epoch:60, avg epoch time:19.6868
 Train loss:1.4117801548942688, Val loss:1.570149302482605, Test loss:1.6132094860076904
 Train acc:59.1608, Val acc:54.1346, Test acc:52.5525
Best Epoch 55,Val 54.8159, Test 53.2607

Epoch:80, avg epoch time:19.7674
 Train loss:1.363571636260502, Val loss:1.5622689723968506, Test loss:1.6063460111618042
 Train acc:60.0971, Val acc:54.5076, Test acc:52.7695
Best Epoch 62,Val 55.1180, Test 53.4467

Epoch:100, avg epoch time:19.7578
 Train loss:1.33070288953327, Val loss:1.5672684907913208, Test loss:1.6117488145828247
 Train acc:60.7401, Val acc:54.1994, Test acc:52.4905
Best Epoch 62,Val 55.1180, Test 53.4467

Epoch:120, avg epoch time:19.7419
 Train loss:1.3048781345761011, Val loss:1.553697109222412, Test loss:1.6013240814208984
 Train acc:61.3737, Val acc:54.5647, Test acc:52.7695
Best Epoch 116,Val 55.4001, Test 53.5134

Epoch:140, avg epoch time:19.7566
 Train loss:1.2832425681371538, Val loss:1.5328152179718018, Test loss:1.5778416395187378
 Train acc:61.8240, Val acc:55.1658, Test acc:53.2202
Best Epoch 127,Val 55.4540, Test 53.5492

Epoch:160, avg epoch time:19.7737
 Train loss:1.2654108433496385, Val loss:1.535286784172058, Test loss:1.5824604034423828
 Train acc:62.1488, Val acc:55.2043, Test acc:53.4729
Best Epoch 127,Val 55.4540, Test 53.5492

Epoch:180, avg epoch time:19.7949
 Train loss:1.2501046979238117, Val loss:1.5346859693527222, Test loss:1.581007719039917
 Train acc:62.5356, Val acc:55.1843, Test acc:53.3847
Best Epoch 172,Val 55.4602, Test 53.7256

Epoch:200, avg epoch time:19.7677
 Train loss:1.2377294283064584, Val loss:1.526780128479004, Test loss:1.569411039352417
 Train acc:62.8213, Val acc:55.3292, Test acc:53.6827
Best Epoch 186,Val 55.6266, Test 53.7710

Epoch:220, avg epoch time:19.7753
 Train loss:1.2254262159741114, Val loss:1.5372679233551025, Test loss:1.5766535997390747
 Train acc:63.0580, Val acc:55.0224, Test acc:53.4038
Best Epoch 186,Val 55.6266, Test 53.7710

Epoch:240, avg epoch time:19.7531
 Train loss:1.2143964294403318, Val loss:1.527252435684204, Test loss:1.5710667371749878
 Train acc:63.3190, Val acc:55.5033, Test acc:53.9045
Best Epoch 186,Val 55.6266, Test 53.7710

Epoch:260, avg epoch time:19.7825
 Train loss:1.2039013268455627, Val loss:1.5207018852233887, Test loss:1.5661535263061523
 Train acc:63.6011, Val acc:55.6343, Test acc:53.8186
Best Epoch 245,Val 55.7422, Test 53.9760

Epoch:280, avg epoch time:19.8026
 Train loss:1.1955968917362274, Val loss:1.5294344425201416, Test loss:1.5751886367797852
 Train acc:63.7450, Val acc:55.3708, Test acc:53.5993
Best Epoch 245,Val 55.7422, Test 53.9760

Epoch:300, avg epoch time:19.8388
 Train loss:1.185178834294516, Val loss:1.5336650609970093, Test loss:1.5737577676773071
 Train acc:63.9901, Val acc:55.3877, Test acc:53.7066
Best Epoch 245,Val 55.7422, Test 53.9760

Epoch:320, avg epoch time:19.8316
 Train loss:1.1802267328141227, Val loss:1.533292293548584, Test loss:1.582438588142395
 Train acc:64.1140, Val acc:55.4494, Test acc:53.4181
Best Epoch 245,Val 55.7422, Test 53.9760

Epoch:340, avg epoch time:19.8407
 Train loss:1.172255796099466, Val loss:1.5290485620498657, Test loss:1.5748231410980225
 Train acc:64.2758, Val acc:55.3893, Test acc:53.6017
Best Epoch 328,Val 55.7576, Test 53.9665

Epoch:360, avg epoch time:19.8446
 Train loss:1.1653559662046886, Val loss:1.5342998504638672, Test loss:1.5831520557403564
 Train acc:64.5136, Val acc:55.2351, Test acc:53.5635
Best Epoch 328,Val 55.7576, Test 53.9665

Epoch:380, avg epoch time:19.8389
 Train loss:1.1581276522742376, Val loss:1.5341235399246216, Test loss:1.5804243087768555
 Train acc:64.6513, Val acc:55.4910, Test acc:53.5611
Best Epoch 328,Val 55.7576, Test 53.9665

Epoch:400, avg epoch time:19.8534
 Train loss:1.1548622941213942, Val loss:1.5342925786972046, Test loss:1.5825601816177368
 Train acc:64.6879, Val acc:55.5095, Test acc:53.6303
Best Epoch 328,Val 55.7576, Test 53.9665

Best Epoch 328, Val 55.7576, Test 53.9665
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:13,  5.50it/s]  3%|▎         | 2/74 [00:00<00:17,  4.07it/s]  4%|▍         | 3/74 [00:00<00:16,  4.22it/s]  5%|▌         | 4/74 [00:01<00:23,  3.00it/s]  7%|▋         | 5/74 [00:01<00:18,  3.64it/s]  8%|▊         | 6/74 [00:01<00:18,  3.62it/s]  9%|▉         | 7/74 [00:01<00:18,  3.54it/s] 11%|█         | 8/74 [00:02<00:15,  4.19it/s] 12%|█▏        | 9/74 [00:02<00:15,  4.25it/s] 14%|█▎        | 10/74 [00:02<00:15,  4.09it/s] 15%|█▍        | 11/74 [00:02<00:14,  4.29it/s] 18%|█▊        | 13/74 [00:02<00:10,  5.81it/s] 19%|█▉        | 14/74 [00:03<00:10,  5.52it/s] 22%|██▏       | 16/74 [00:03<00:08,  7.04it/s] 24%|██▍       | 18/74 [00:03<00:07,  7.43it/s] 27%|██▋       | 20/74 [00:03<00:06,  8.19it/s] 30%|██▉       | 22/74 [00:04<00:07,  7.17it/s] 31%|███       | 23/74 [00:04<00:08,  5.76it/s] 32%|███▏      | 24/74 [00:04<00:09,  5.34it/s] 34%|███▍      | 25/74 [00:05<00:10,  4.67it/s] 35%|███▌      | 26/74 [00:05<00:10,  4.39it/s] 36%|███▋      | 27/74 [00:05<00:11,  3.95it/s] 38%|███▊      | 28/74 [00:05<00:12,  3.67it/s] 39%|███▉      | 29/74 [00:06<00:12,  3.63it/s] 41%|████      | 30/74 [00:06<00:11,  3.96it/s] 42%|████▏     | 31/74 [00:06<00:12,  3.55it/s] 43%|████▎     | 32/74 [00:06<00:11,  3.80it/s] 45%|████▍     | 33/74 [00:07<00:12,  3.32it/s] 46%|████▌     | 34/74 [00:07<00:11,  3.61it/s] 47%|████▋     | 35/74 [00:07<00:11,  3.45it/s] 49%|████▊     | 36/74 [00:08<00:11,  3.25it/s] 50%|█████     | 37/74 [00:08<00:12,  3.02it/s] 51%|█████▏    | 38/74 [00:08<00:10,  3.31it/s] 53%|█████▎    | 39/74 [00:09<00:10,  3.39it/s] 54%|█████▍    | 40/74 [00:09<00:09,  3.58it/s] 55%|█████▌    | 41/74 [00:09<00:09,  3.50it/s] 57%|█████▋    | 42/74 [00:10<00:12,  2.67it/s] 58%|█████▊    | 43/74 [00:10<00:10,  2.97it/s] 59%|█████▉    | 44/74 [00:10<00:09,  3.23it/s] 61%|██████    | 45/74 [00:11<00:08,  3.47it/s] 62%|██████▏   | 46/74 [00:11<00:08,  3.44it/s] 64%|██████▎   | 47/74 [00:11<00:07,  3.66it/s] 65%|██████▍   | 48/74 [00:11<00:07,  3.68it/s] 66%|██████▌   | 49/74 [00:12<00:07,  3.33it/s] 68%|██████▊   | 50/74 [00:12<00:07,  3.28it/s] 69%|██████▉   | 51/74 [00:12<00:06,  3.30it/s] 70%|███████   | 52/74 [00:13<00:07,  2.98it/s] 72%|███████▏  | 53/74 [00:13<00:07,  2.93it/s] 73%|███████▎  | 54/74 [00:13<00:05,  3.34it/s] 74%|███████▍  | 55/74 [00:13<00:04,  4.08it/s] 76%|███████▌  | 56/74 [00:14<00:03,  4.68it/s] 77%|███████▋  | 57/74 [00:14<00:03,  4.38it/s] 78%|███████▊  | 58/74 [00:14<00:03,  4.36it/s] 80%|███████▉  | 59/74 [00:14<00:03,  4.81it/s] 81%|████████  | 60/74 [00:14<00:02,  4.93it/s] 82%|████████▏ | 61/74 [00:15<00:03,  3.77it/s] 84%|████████▍ | 62/74 [00:15<00:02,  4.13it/s] 85%|████████▌ | 63/74 [00:15<00:02,  4.37it/s] 86%|████████▋ | 64/74 [00:15<00:02,  4.60it/s] 88%|████████▊ | 65/74 [00:15<00:01,  5.37it/s] 89%|████████▉ | 66/74 [00:16<00:01,  6.04it/s] 91%|█████████ | 67/74 [00:16<00:01,  5.23it/s] 92%|█████████▏| 68/74 [00:16<00:01,  4.40it/s] 93%|█████████▎| 69/74 [00:16<00:01,  4.70it/s] 95%|█████████▍| 70/74 [00:17<00:00,  4.75it/s] 96%|█████████▌| 71/74 [00:17<00:00,  3.52it/s] 97%|█████████▋| 72/74 [00:17<00:00,  4.16it/s] 99%|█████████▊| 73/74 [00:17<00:00,  4.24it/s]100%|██████████| 74/74 [00:17<00:00,  5.13it/s]100%|██████████| 74/74 [00:17<00:00,  4.12it/s]
Stage 1 

Stage 0 history model:
	Train acc 73.3957 Val acc 55.7576 Test acc 53.9665
Stage: 1, threshold 0.75, confident nodes: 34072 / 106818
		 val confident nodes: 21576 / 64879,  val confident level: 0.8170652389526367
		test confident nodes: 12496 / 41939, test confident_level: 0.8051376342773438
Current num label hops = 2
# Params: 15406129
Epoch:20, avg epoch time:27.4159
 Train loss:1.5803014858445126, Val loss:1.5907195806503296, Test loss:1.6453869342803955
 Train acc:57.2955, Val acc:56.3834, Test acc:54.7152
Best Epoch 17,Val 56.5653, Test 54.7676

Epoch:40, avg epoch time:27.7690
 Train loss:1.4238850091820332, Val loss:1.5925986766815186, Test loss:1.655959963798523
 Train acc:59.6109, Val acc:56.7518, Test acc:55.2588
Best Epoch 31,Val 57.4192, Test 55.3399

Epoch:60, avg epoch time:27.7142
 Train loss:1.337080953726128, Val loss:1.5926729440689087, Test loss:1.668951153755188
 Train acc:61.1292, Val acc:57.0878, Test acc:55.2278
Best Epoch 52,Val 57.4855, Test 55.5926

Epoch:80, avg epoch time:27.6620
 Train loss:1.2813636367000751, Val loss:1.5999411344528198, Test loss:1.6791906356811523
 Train acc:62.1485, Val acc:57.3360, Test acc:55.4090
Best Epoch 71,Val 57.6057, Test 55.6403

Epoch:100, avg epoch time:27.7112
 Train loss:1.2405839571312292, Val loss:1.6245242357254028, Test loss:1.7116063833236694
 Train acc:63.0078, Val acc:57.1263, Test acc:55.2302
Best Epoch 71,Val 57.6057, Test 55.6403

Epoch:120, avg epoch time:27.7426
 Train loss:1.2058780869441246, Val loss:1.6198292970657349, Test loss:1.7170677185058594
 Train acc:63.6464, Val acc:57.4593, Test acc:55.5092
Best Epoch 103,Val 57.8400, Test 55.7572

Epoch:140, avg epoch time:27.7935
 Train loss:1.1815101121788594, Val loss:1.6545329093933105, Test loss:1.742529273033142
 Train acc:64.1909, Val acc:57.0015, Test acc:55.1539
Best Epoch 103,Val 57.8400, Test 55.7572

Epoch:160, avg epoch time:27.7768
 Train loss:1.1554825252561427, Val loss:1.6434515714645386, Test loss:1.7401986122131348
 Train acc:64.7739, Val acc:57.6920, Test acc:55.8001
Best Epoch 103,Val 57.8400, Test 55.7572

Epoch:180, avg epoch time:27.7873
 Train loss:1.1358053986705952, Val loss:1.6747249364852905, Test loss:1.7743711471557617
 Train acc:65.1545, Val acc:57.4284, Test acc:55.4853
Best Epoch 176,Val 57.8939, Test 55.6403

Epoch:200, avg epoch time:27.7570
 Train loss:1.1195645972863952, Val loss:1.6549546718597412, Test loss:1.75439453125
 Train acc:65.5448, Val acc:57.7336, Test acc:55.7476
Best Epoch 176,Val 57.8939, Test 55.6403

Epoch:220, avg epoch time:27.7512
 Train loss:1.1028956281605051, Val loss:1.6598504781723022, Test loss:1.759083867073059
 Train acc:65.9862, Val acc:57.6242, Test acc:55.7333
Best Epoch 176,Val 57.8939, Test 55.6403

Epoch:240, avg epoch time:27.7745
 Train loss:1.0899478837625305, Val loss:1.7207880020141602, Test loss:1.8121898174285889
 Train acc:66.2022, Val acc:56.9660, Test acc:55.3208
Best Epoch 176,Val 57.8939, Test 55.6403

Epoch:260, avg epoch time:27.7300
 Train loss:1.0777854723716849, Val loss:1.7026110887527466, Test loss:1.7942062616348267
 Train acc:66.5359, Val acc:57.5518, Test acc:55.5688
Best Epoch 176,Val 57.8939, Test 55.6403

Best Epoch 176, Val 57.8939, Test 55.6403
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:19,  3.68it/s]  3%|▎         | 2/74 [00:00<00:27,  2.66it/s]  4%|▍         | 3/74 [00:01<00:27,  2.60it/s]  5%|▌         | 4/74 [00:01<00:29,  2.34it/s]  7%|▋         | 5/74 [00:02<00:31,  2.20it/s]  8%|▊         | 6/74 [00:02<00:29,  2.30it/s]  9%|▉         | 7/74 [00:02<00:27,  2.46it/s] 11%|█         | 8/74 [00:03<00:22,  2.96it/s] 12%|█▏        | 9/74 [00:03<00:20,  3.20it/s] 14%|█▎        | 10/74 [00:03<00:20,  3.10it/s] 15%|█▍        | 11/74 [00:03<00:20,  3.06it/s] 16%|█▌        | 12/74 [00:04<00:19,  3.14it/s] 18%|█▊        | 13/74 [00:04<00:19,  3.15it/s] 19%|█▉        | 14/74 [00:05<00:20,  2.90it/s] 20%|██        | 15/74 [00:05<00:22,  2.62it/s] 22%|██▏       | 16/74 [00:05<00:19,  3.00it/s] 23%|██▎       | 17/74 [00:05<00:16,  3.44it/s] 24%|██▍       | 18/74 [00:06<00:18,  3.00it/s] 26%|██▌       | 19/74 [00:06<00:17,  3.17it/s] 27%|██▋       | 20/74 [00:06<00:16,  3.33it/s] 28%|██▊       | 21/74 [00:07<00:14,  3.64it/s] 30%|██▉       | 22/74 [00:07<00:14,  3.71it/s] 31%|███       | 23/74 [00:07<00:13,  3.73it/s] 32%|███▏      | 24/74 [00:08<00:16,  3.06it/s] 34%|███▍      | 25/74 [00:08<00:17,  2.79it/s] 35%|███▌      | 26/74 [00:08<00:17,  2.79it/s] 36%|███▋      | 27/74 [00:09<00:16,  2.88it/s] 38%|███▊      | 28/74 [00:09<00:14,  3.10it/s] 39%|███▉      | 29/74 [00:09<00:12,  3.56it/s] 41%|████      | 30/74 [00:09<00:10,  4.05it/s] 42%|████▏     | 31/74 [00:10<00:12,  3.50it/s] 43%|████▎     | 32/74 [00:10<00:11,  3.61it/s] 45%|████▍     | 33/74 [00:10<00:11,  3.43it/s] 46%|████▌     | 34/74 [00:11<00:12,  3.22it/s] 47%|████▋     | 35/74 [00:11<00:10,  3.72it/s] 49%|████▊     | 36/74 [00:11<00:08,  4.23it/s] 50%|█████     | 37/74 [00:11<00:09,  4.09it/s] 51%|█████▏    | 38/74 [00:11<00:08,  4.42it/s] 53%|█████▎    | 39/74 [00:12<00:07,  4.82it/s] 54%|█████▍    | 40/74 [00:12<00:06,  5.32it/s] 55%|█████▌    | 41/74 [00:12<00:05,  6.04it/s] 57%|█████▋    | 42/74 [00:12<00:05,  6.31it/s] 58%|█████▊    | 43/74 [00:13<00:09,  3.42it/s] 59%|█████▉    | 44/74 [00:13<00:09,  3.22it/s] 61%|██████    | 45/74 [00:13<00:08,  3.31it/s] 62%|██████▏   | 46/74 [00:14<00:08,  3.24it/s] 64%|██████▎   | 47/74 [00:14<00:07,  3.53it/s] 65%|██████▍   | 48/74 [00:14<00:06,  3.76it/s] 66%|██████▌   | 49/74 [00:14<00:06,  3.62it/s] 68%|██████▊   | 50/74 [00:15<00:06,  3.50it/s] 69%|██████▉   | 51/74 [00:15<00:06,  3.64it/s] 70%|███████   | 52/74 [00:15<00:05,  3.68it/s] 72%|███████▏  | 53/74 [00:16<00:07,  2.90it/s] 73%|███████▎  | 54/74 [00:16<00:06,  2.89it/s] 74%|███████▍  | 55/74 [00:16<00:06,  2.92it/s] 76%|███████▌  | 56/74 [00:17<00:05,  3.25it/s] 77%|███████▋  | 57/74 [00:17<00:05,  3.23it/s] 78%|███████▊  | 58/74 [00:17<00:04,  3.49it/s] 80%|███████▉  | 59/74 [00:17<00:03,  4.06it/s] 81%|████████  | 60/74 [00:17<00:03,  4.63it/s] 82%|████████▏ | 61/74 [00:18<00:03,  3.79it/s] 84%|████████▍ | 62/74 [00:18<00:03,  3.26it/s] 85%|████████▌ | 63/74 [00:18<00:03,  3.56it/s] 86%|████████▋ | 64/74 [00:19<00:02,  3.74it/s] 88%|████████▊ | 65/74 [00:19<00:02,  4.09it/s] 89%|████████▉ | 66/74 [00:19<00:01,  4.00it/s] 91%|█████████ | 67/74 [00:19<00:01,  3.62it/s] 92%|█████████▏| 68/74 [00:20<00:01,  3.62it/s] 93%|█████████▎| 69/74 [00:20<00:01,  3.57it/s] 95%|█████████▍| 70/74 [00:20<00:01,  3.12it/s] 96%|█████████▌| 71/74 [00:21<00:00,  3.46it/s] 97%|█████████▋| 72/74 [00:21<00:00,  2.93it/s] 99%|█████████▊| 73/74 [00:21<00:00,  3.27it/s]100%|██████████| 74/74 [00:21<00:00,  3.53it/s]100%|██████████| 74/74 [00:21<00:00,  3.37it/s]
Stage 2 

Stage 1 history model:
	Train acc 72.7036 Val acc 57.8939 Test acc 55.6403
Stage: 2, threshold 0.75, confident nodes: 57474 / 106818
		 val confident nodes: 35082 / 64879,  val confident level: 0.7542044520378113
		test confident nodes: 22392 / 41939, test confident_level: 0.7291889786720276
Current num label hops = 2
# Params: 15406129
Epoch:20, avg epoch time:28.4066
 Train loss:1.6785384399303491, Val loss:1.6874223947525024, Test loss:1.7841402292251587
 Train acc:56.7774, Val acc:57.4284, Test acc:55.6523
Best Epoch 16,Val 57.4670, Test 55.8931

Epoch:40, avg epoch time:28.6527
 Train loss:1.4984302641688914, Val loss:1.7275162935256958, Test loss:1.8670811653137207
 Train acc:58.9074, Val acc:57.8138, Test acc:55.7691
Best Epoch 34,Val 57.9695, Test 55.9002

Epoch:60, avg epoch time:28.4307
 Train loss:1.3995671600535295, Val loss:1.7622346878051758, Test loss:1.912217378616333
 Train acc:60.3157, Val acc:57.7937, Test acc:55.9360
Best Epoch 45,Val 58.2068, Test 56.5083

Epoch:80, avg epoch time:28.4825
 Train loss:1.335143536761187, Val loss:1.8115029335021973, Test loss:1.976923942565918
 Train acc:61.3669, Val acc:58.0758, Test acc:56.1744
Best Epoch 78,Val 58.2978, Test 56.2293

Epoch:100, avg epoch time:28.5812
 Train loss:1.2902013581732046, Val loss:1.8241876363754272, Test loss:1.9903706312179565
 Train acc:62.1107, Val acc:58.2238, Test acc:56.3390
Best Epoch 78,Val 58.2978, Test 56.2293

Epoch:120, avg epoch time:28.6129
 Train loss:1.2563908186511716, Val loss:1.863450527191162, Test loss:2.041889190673828
 Train acc:62.7419, Val acc:58.1914, Test acc:56.2555
Best Epoch 102,Val 58.5459, Test 56.4391

Epoch:140, avg epoch time:28.5865
 Train loss:1.2224043659541919, Val loss:1.874568223953247, Test loss:2.0619890689849854
 Train acc:63.3430, Val acc:58.2762, Test acc:56.3986
Best Epoch 102,Val 58.5459, Test 56.4391

Epoch:160, avg epoch time:28.5447
 Train loss:1.1973480089851047, Val loss:1.928311824798584, Test loss:2.118222236633301
 Train acc:63.7865, Val acc:58.3440, Test acc:56.4534
Best Epoch 102,Val 58.5459, Test 56.4391

Epoch:180, avg epoch time:28.6688
 Train loss:1.1774964038876519, Val loss:1.9265904426574707, Test loss:2.1112775802612305
 Train acc:64.2847, Val acc:58.3872, Test acc:56.4844
Best Epoch 102,Val 58.5459, Test 56.4391

Epoch:200, avg epoch time:28.6884
 Train loss:1.160513618718023, Val loss:1.9175102710723877, Test loss:2.0987977981567383
 Train acc:64.6205, Val acc:58.4103, Test acc:56.4868
Best Epoch 102,Val 58.5459, Test 56.4391

Best Epoch 102, Val 58.5459, Test 56.4391
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:22,  3.30it/s]  3%|▎         | 2/74 [00:00<00:21,  3.34it/s]  4%|▍         | 3/74 [00:00<00:20,  3.53it/s]  5%|▌         | 4/74 [00:01<00:18,  3.72it/s]  7%|▋         | 5/74 [00:01<00:14,  4.68it/s]  8%|▊         | 6/74 [00:01<00:14,  4.83it/s]  9%|▉         | 7/74 [00:01<00:15,  4.43it/s] 11%|█         | 8/74 [00:02<00:20,  3.17it/s] 12%|█▏        | 9/74 [00:02<00:21,  2.96it/s] 14%|█▎        | 10/74 [00:02<00:22,  2.82it/s] 15%|█▍        | 11/74 [00:03<00:22,  2.83it/s] 16%|█▌        | 12/74 [00:03<00:20,  3.09it/s] 18%|█▊        | 13/74 [00:03<00:17,  3.51it/s] 19%|█▉        | 14/74 [00:03<00:15,  3.75it/s] 20%|██        | 15/74 [00:04<00:14,  4.13it/s] 22%|██▏       | 16/74 [00:04<00:15,  3.79it/s] 23%|██▎       | 17/74 [00:05<00:19,  2.88it/s] 24%|██▍       | 18/74 [00:05<00:19,  2.89it/s] 26%|██▌       | 19/74 [00:05<00:17,  3.21it/s] 27%|██▋       | 20/74 [00:05<00:15,  3.56it/s] 28%|██▊       | 21/74 [00:06<00:14,  3.75it/s] 30%|██▉       | 22/74 [00:06<00:14,  3.66it/s] 31%|███       | 23/74 [00:06<00:12,  4.06it/s] 32%|███▏      | 24/74 [00:06<00:11,  4.43it/s] 34%|███▍      | 25/74 [00:06<00:10,  4.75it/s] 35%|███▌      | 26/74 [00:07<00:10,  4.53it/s] 36%|███▋      | 27/74 [00:07<00:12,  3.85it/s] 38%|███▊      | 28/74 [00:07<00:11,  4.09it/s] 39%|███▉      | 29/74 [00:07<00:10,  4.13it/s] 41%|████      | 30/74 [00:08<00:12,  3.46it/s] 42%|████▏     | 31/74 [00:08<00:12,  3.40it/s] 43%|████▎     | 32/74 [00:08<00:12,  3.41it/s] 45%|████▍     | 33/74 [00:09<00:12,  3.38it/s] 46%|████▌     | 34/74 [00:09<00:12,  3.22it/s] 47%|████▋     | 35/74 [00:09<00:12,  3.06it/s] 49%|████▊     | 36/74 [00:10<00:12,  3.06it/s] 50%|█████     | 37/74 [00:10<00:12,  2.98it/s] 51%|█████▏    | 38/74 [00:10<00:12,  2.85it/s] 53%|█████▎    | 39/74 [00:11<00:12,  2.82it/s] 54%|█████▍    | 40/74 [00:11<00:11,  3.06it/s] 55%|█████▌    | 41/74 [00:11<00:10,  3.11it/s] 57%|█████▋    | 42/74 [00:12<00:10,  3.04it/s] 58%|█████▊    | 43/74 [00:12<00:09,  3.32it/s] 59%|█████▉    | 44/74 [00:12<00:07,  4.00it/s] 61%|██████    | 45/74 [00:12<00:06,  4.32it/s] 62%|██████▏   | 46/74 [00:13<00:07,  3.58it/s] 64%|██████▎   | 47/74 [00:13<00:08,  3.15it/s] 65%|██████▍   | 48/74 [00:13<00:06,  3.80it/s] 66%|██████▌   | 49/74 [00:13<00:05,  4.26it/s] 68%|██████▊   | 50/74 [00:14<00:06,  3.81it/s] 69%|██████▉   | 51/74 [00:14<00:06,  3.62it/s] 70%|███████   | 52/74 [00:14<00:06,  3.37it/s] 72%|███████▏  | 53/74 [00:15<00:06,  3.16it/s] 73%|███████▎  | 54/74 [00:15<00:06,  2.92it/s] 74%|███████▍  | 55/74 [00:16<00:07,  2.44it/s] 76%|███████▌  | 56/74 [00:16<00:06,  2.70it/s] 77%|███████▋  | 57/74 [00:16<00:05,  3.10it/s] 78%|███████▊  | 58/74 [00:17<00:04,  3.22it/s] 80%|███████▉  | 59/74 [00:17<00:04,  3.40it/s] 81%|████████  | 60/74 [00:17<00:04,  3.46it/s] 82%|████████▏ | 61/74 [00:17<00:03,  3.43it/s] 84%|████████▍ | 62/74 [00:18<00:04,  3.00it/s] 85%|████████▌ | 63/74 [00:18<00:03,  3.00it/s] 86%|████████▋ | 64/74 [00:19<00:03,  2.83it/s] 88%|████████▊ | 65/74 [00:19<00:03,  2.40it/s] 89%|████████▉ | 66/74 [00:19<00:03,  2.49it/s] 91%|█████████ | 67/74 [00:20<00:02,  2.85it/s] 92%|█████████▏| 68/74 [00:20<00:01,  3.02it/s] 93%|█████████▎| 69/74 [00:20<00:01,  2.96it/s] 95%|█████████▍| 70/74 [00:21<00:01,  3.01it/s] 96%|█████████▌| 71/74 [00:21<00:00,  3.01it/s] 97%|█████████▋| 72/74 [00:21<00:00,  3.03it/s] 99%|█████████▊| 73/74 [00:22<00:00,  2.77it/s]100%|██████████| 74/74 [00:22<00:00,  2.96it/s]100%|██████████| 74/74 [00:22<00:00,  3.29it/s]
Stage 3 

Stage 2 history model:
	Train acc 67.3117 Val acc 58.5459 Test acc 56.4391
Stage: 3, threshold 0.75, confident nodes: 69406 / 106818
		 val confident nodes: 42070 / 64879,  val confident level: 0.7180413603782654
		test confident nodes: 27336 / 41939, test confident_level: 0.6860550045967102
Current num label hops = 2
# Params: 15406129
Epoch:20, avg epoch time:28.6500
 Train loss:1.7400775160108293, Val loss:1.7519747018814087, Test loss:1.8753985166549683
 Train acc:56.3790, Val acc:57.7383, Test acc:55.6546
Best Epoch 17,Val 57.8878, Test 55.9551

Epoch:40, avg epoch time:28.0932
 Train loss:1.5425876889910017, Val loss:1.8276677131652832, Test loss:2.0019607543945312
 Train acc:58.5225, Val acc:58.0928, Test acc:56.0004
Best Epoch 24,Val 58.2762, Test 56.3819

Epoch:60, avg epoch time:27.2274
 Train loss:1.439364297049386, Val loss:1.8718035221099854, Test loss:2.066474676132202
 Train acc:59.8571, Val acc:58.2346, Test acc:56.3819
Best Epoch 57,Val 58.4211, Test 56.5178

Epoch:80, avg epoch time:26.7203
 Train loss:1.3703113794326782, Val loss:1.9507133960723877, Test loss:2.1810882091522217
 Train acc:60.7317, Val acc:58.4503, Test acc:56.3580
Best Epoch 78,Val 58.5028, Test 56.5726

Epoch:100, avg epoch time:26.4459
 Train loss:1.3247069699423655, Val loss:1.9965879917144775, Test loss:2.237436294555664
 Train acc:61.4677, Val acc:58.4935, Test acc:56.3867
Best Epoch 94,Val 58.6846, Test 56.6942

Epoch:120, avg epoch time:26.1914
 Train loss:1.2876780544008528, Val loss:2.0147876739501953, Test loss:2.2520523071289062
 Train acc:62.0931, Val acc:58.4627, Test acc:56.4892
Best Epoch 94,Val 58.6846, Test 56.6942

Epoch:140, avg epoch time:25.9669
 Train loss:1.2604516131537302, Val loss:2.069263219833374, Test loss:2.325392723083496
 Train acc:62.5577, Val acc:58.5536, Test acc:56.4701
Best Epoch 126,Val 58.6877, Test 56.6895

Epoch:160, avg epoch time:25.8174
 Train loss:1.2322127904210771, Val loss:2.1327195167541504, Test loss:2.403010845184326
 Train acc:63.0823, Val acc:58.5089, Test acc:56.5250
Best Epoch 158,Val 58.7386, Test 56.6132

Epoch:180, avg epoch time:25.7277
 Train loss:1.212950474875314, Val loss:2.1167914867401123, Test loss:2.379908323287964
 Train acc:63.4661, Val acc:58.4812, Test acc:56.5321
Best Epoch 173,Val 58.7648, Test 56.6179

Epoch:200, avg epoch time:25.6109
 Train loss:1.1927767430033003, Val loss:2.1268422603607178, Test loss:2.386763334274292
 Train acc:63.8640, Val acc:58.6368, Test acc:56.7729
Best Epoch 189,Val 58.7941, Test 56.7586

Epoch:220, avg epoch time:25.4834
 Train loss:1.1770462155342103, Val loss:2.1846566200256348, Test loss:2.4691269397735596
 Train acc:64.1543, Val acc:58.5536, Test acc:56.3819
Best Epoch 214,Val 58.8449, Test 56.6847

Epoch:240, avg epoch time:25.3933
 Train loss:1.1643108657428196, Val loss:2.1264524459838867, Test loss:2.3925700187683105
 Train acc:64.3970, Val acc:58.6862, Test acc:56.5774
Best Epoch 214,Val 58.8449, Test 56.6847

Epoch:260, avg epoch time:25.2689
 Train loss:1.1504330158233642, Val loss:2.2457332611083984, Test loss:2.538686752319336
 Train acc:64.7358, Val acc:58.5567, Test acc:56.4892
Best Epoch 214,Val 58.8449, Test 56.6847

Epoch:280, avg epoch time:25.1917
 Train loss:1.1394342235156467, Val loss:2.2418789863586426, Test loss:2.52927303314209
 Train acc:64.9669, Val acc:58.5166, Test acc:56.4248
Best Epoch 214,Val 58.8449, Test 56.6847

Epoch:300, avg epoch time:25.1296
 Train loss:1.1273608139583042, Val loss:2.2378180027008057, Test loss:2.513493061065674
 Train acc:65.1822, Val acc:58.5320, Test acc:56.6466
Best Epoch 214,Val 58.8449, Test 56.6847

Best Epoch 214, Val 58.8449, Test 56.6847
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:22,  3.30it/s]  3%|▎         | 2/74 [00:00<00:27,  2.60it/s]  4%|▍         | 3/74 [00:01<00:23,  3.07it/s]  5%|▌         | 4/74 [00:01<00:21,  3.26it/s]  7%|▋         | 5/74 [00:01<00:21,  3.28it/s]  8%|▊         | 6/74 [00:01<00:19,  3.53it/s]  9%|▉         | 7/74 [00:02<00:17,  3.92it/s] 11%|█         | 8/74 [00:02<00:15,  4.34it/s] 12%|█▏        | 9/74 [00:02<00:15,  4.28it/s] 14%|█▎        | 10/74 [00:02<00:15,  4.07it/s] 15%|█▍        | 11/74 [00:02<00:15,  4.06it/s] 16%|█▌        | 12/74 [00:03<00:18,  3.43it/s] 18%|█▊        | 13/74 [00:03<00:17,  3.58it/s] 19%|█▉        | 14/74 [00:03<00:16,  3.58it/s] 20%|██        | 15/74 [00:04<00:15,  3.81it/s] 22%|██▏       | 16/74 [00:04<00:14,  4.10it/s] 23%|██▎       | 17/74 [00:04<00:14,  3.85it/s] 24%|██▍       | 18/74 [00:04<00:14,  3.97it/s] 26%|██▌       | 19/74 [00:05<00:12,  4.26it/s] 27%|██▋       | 20/74 [00:05<00:11,  4.53it/s] 28%|██▊       | 21/74 [00:05<00:14,  3.55it/s] 30%|██▉       | 22/74 [00:05<00:14,  3.50it/s] 31%|███       | 23/74 [00:06<00:14,  3.57it/s] 32%|███▏      | 24/74 [00:06<00:13,  3.82it/s] 34%|███▍      | 25/74 [00:06<00:11,  4.18it/s] 35%|███▌      | 26/74 [00:06<00:10,  4.54it/s] 36%|███▋      | 27/74 [00:06<00:09,  4.82it/s] 38%|███▊      | 28/74 [00:07<00:10,  4.27it/s] 39%|███▉      | 29/74 [00:07<00:11,  4.02it/s] 41%|████      | 30/74 [00:07<00:11,  3.90it/s] 42%|████▏     | 31/74 [00:08<00:11,  3.70it/s] 43%|████▎     | 32/74 [00:08<00:11,  3.58it/s] 45%|████▍     | 33/74 [00:08<00:11,  3.72it/s] 46%|████▌     | 34/74 [00:08<00:10,  3.88it/s] 47%|████▋     | 35/74 [00:09<00:09,  3.92it/s] 49%|████▊     | 36/74 [00:09<00:09,  3.87it/s] 50%|█████     | 37/74 [00:09<00:09,  3.93it/s] 51%|█████▏    | 38/74 [00:09<00:09,  3.76it/s] 53%|█████▎    | 39/74 [00:10<00:08,  4.08it/s] 54%|█████▍    | 40/74 [00:10<00:11,  3.08it/s] 55%|█████▌    | 41/74 [00:10<00:10,  3.15it/s] 57%|█████▋    | 42/74 [00:11<00:09,  3.55it/s] 58%|█████▊    | 43/74 [00:11<00:08,  3.45it/s] 59%|█████▉    | 44/74 [00:11<00:08,  3.54it/s] 61%|██████    | 45/74 [00:12<00:08,  3.41it/s] 62%|██████▏   | 46/74 [00:12<00:07,  3.70it/s] 64%|██████▎   | 47/74 [00:12<00:06,  4.40it/s] 65%|██████▍   | 48/74 [00:12<00:05,  5.18it/s] 66%|██████▌   | 49/74 [00:12<00:04,  5.67it/s] 68%|██████▊   | 50/74 [00:13<00:05,  4.24it/s] 69%|██████▉   | 51/74 [00:13<00:05,  4.25it/s] 70%|███████   | 52/74 [00:13<00:05,  3.92it/s] 72%|███████▏  | 53/74 [00:13<00:05,  3.55it/s] 73%|███████▎  | 54/74 [00:14<00:05,  3.51it/s] 74%|███████▍  | 55/74 [00:14<00:06,  3.16it/s] 76%|███████▌  | 56/74 [00:14<00:05,  3.02it/s] 77%|███████▋  | 57/74 [00:15<00:05,  3.15it/s] 78%|███████▊  | 58/74 [00:15<00:05,  3.19it/s] 80%|███████▉  | 59/74 [00:16<00:05,  2.65it/s] 81%|████████  | 60/74 [00:16<00:04,  2.83it/s] 82%|████████▏ | 61/74 [00:16<00:04,  3.02it/s] 84%|████████▍ | 62/74 [00:17<00:04,  2.86it/s] 85%|████████▌ | 63/74 [00:17<00:03,  3.06it/s] 86%|████████▋ | 64/74 [00:17<00:03,  2.96it/s] 88%|████████▊ | 65/74 [00:17<00:03,  2.97it/s] 89%|████████▉ | 66/74 [00:18<00:02,  2.81it/s] 91%|█████████ | 67/74 [00:18<00:02,  2.93it/s] 92%|█████████▏| 68/74 [00:18<00:01,  3.17it/s] 93%|█████████▎| 69/74 [00:19<00:01,  3.03it/s] 95%|█████████▍| 70/74 [00:19<00:01,  3.11it/s] 96%|█████████▌| 71/74 [00:19<00:00,  3.20it/s] 97%|█████████▋| 72/74 [00:20<00:00,  3.60it/s] 99%|█████████▊| 73/74 [00:20<00:00,  3.77it/s]100%|██████████| 74/74 [00:20<00:00,  3.98it/s]100%|██████████| 74/74 [00:20<00:00,  3.60it/s]
