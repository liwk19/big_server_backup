Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.2.5, while the latest version is 1.3.3.
Namespace(seed=1, dataset='ogbn-mag', gpu=0, root='../data/', emb_path='../data/', stages=[400, 400, 400, 400], extra_embedding='complex', embed_size=256, num_hops=2, label_feats=True, num_label_hops=2, hidden=512, dropout=0.5, n_layers_1=2, n_layers_2=2, n_layers_3=4, input_drop=0.1, att_drop=0.0, label_drop=0.0, residual=True, act='leaky_relu', bns=True, label_bns=True, amp=True, lr=0.001, weight_decay=0.0, eval_every=1, batch_size=10000, patience=100, threshold=0.75, gama=10.0, start_stage=0, reload='', moving_k=1, store_model=False, moe_widget=[], num_expert=1, top_k=1, expert_drop=0.0, gate='naive')
Use extra embeddings generated with the complex method
Current num hops = 2
./output/ogbn-mag/4e56522a2e724fd1b5af5f6dfa3ef397 

Stage 0 

Current num label hops = 2
# Params: 8371231
Epoch:20, avg epoch time:16.5116
 Train loss:1.5765293250008234, Val loss:1.6413284540176392, Test loss:1.6806036233901978
 Train acc:56.1362, Val acc:53.0649, Test acc:51.5296
Best Epoch 18,Val 53.4164, Test 51.9397

Epoch:40, avg epoch time:16.0411
 Train loss:1.4461825291315715, Val loss:1.569002389907837, Test loss:1.6146771907806396
 Train acc:58.5237, Val acc:54.2194, Test acc:52.5382
Best Epoch 23,Val 54.5801, Test 52.9603

Epoch:60, avg epoch time:15.9774
 Train loss:1.3783443011934795, Val loss:1.5526231527328491, Test loss:1.601256251335144
 Train acc:59.8882, Val acc:54.6386, Test acc:53.1105
Best Epoch 57,Val 54.7296, Test 53.0676

Epoch:80, avg epoch time:16.0153
 Train loss:1.3303637618110293, Val loss:1.5488226413726807, Test loss:1.5961672067642212
 Train acc:60.8972, Val acc:54.7280, Test acc:53.0413
Best Epoch 68,Val 55.0486, Test 53.4348

Epoch:100, avg epoch time:15.9209
 Train loss:1.2958361440234714, Val loss:1.5392496585845947, Test loss:1.5852770805358887
 Train acc:61.5754, Val acc:54.9315, Test acc:53.3298
Best Epoch 90,Val 55.0764, Test 53.3632

Epoch:120, avg epoch time:15.8265
 Train loss:1.269693864716424, Val loss:1.5411007404327393, Test loss:1.591539740562439
 Train acc:62.1182, Val acc:54.9161, Test acc:53.2130
Best Epoch 110,Val 55.2829, Test 53.5778

Epoch:140, avg epoch time:15.6993
 Train loss:1.2493644006668576, Val loss:1.5268118381500244, Test loss:1.5716032981872559
 Train acc:62.5434, Val acc:55.3754, Test acc:53.6231
Best Epoch 134,Val 55.4941, Test 53.7924

Epoch:160, avg epoch time:15.6622
 Train loss:1.2295429460586063, Val loss:1.5366770029067993, Test loss:1.5850210189819336
 Train acc:62.9587, Val acc:55.2197, Test acc:53.3966
Best Epoch 134,Val 55.4941, Test 53.7924

Epoch:180, avg epoch time:15.6389
 Train loss:1.2146187112444924, Val loss:1.53009831905365, Test loss:1.576236605644226
 Train acc:63.3851, Val acc:55.4694, Test acc:53.7710
Best Epoch 170,Val 55.6698, Test 53.9259

Epoch:200, avg epoch time:15.6268
 Train loss:1.1998796198103163, Val loss:1.5356762409210205, Test loss:1.581583857536316
 Train acc:63.6564, Val acc:55.1796, Test acc:53.6470
Best Epoch 170,Val 55.6698, Test 53.9259

Epoch:220, avg epoch time:15.6100
 Train loss:1.185983243442717, Val loss:1.5417298078536987, Test loss:1.5900312662124634
 Train acc:64.0670, Val acc:55.2136, Test acc:53.4228
Best Epoch 207,Val 55.7653, Test 53.8854

Epoch:240, avg epoch time:15.2947
 Train loss:1.1756091439534748, Val loss:1.5317211151123047, Test loss:1.5807329416275024
 Train acc:64.2368, Val acc:55.6112, Test acc:53.7710
Best Epoch 207,Val 55.7653, Test 53.8854

Epoch:260, avg epoch time:14.7225
 Train loss:1.1649382682073683, Val loss:1.5327073335647583, Test loss:1.5821596384048462
 Train acc:64.4866, Val acc:55.4586, Test acc:53.6613
Best Epoch 207,Val 55.7653, Test 53.8854

Epoch:280, avg epoch time:14.4445
 Train loss:1.1579810721533639, Val loss:1.5348714590072632, Test loss:1.5850534439086914
 Train acc:64.6313, Val acc:55.6020, Test acc:53.7113
Best Epoch 207,Val 55.7653, Test 53.8854

Epoch:300, avg epoch time:14.3355
 Train loss:1.147364413927472, Val loss:1.552214503288269, Test loss:1.601670503616333
 Train acc:64.8955, Val acc:55.1596, Test acc:53.2774
Best Epoch 290,Val 55.7885, Test 54.0189

Epoch:320, avg epoch time:14.2411
 Train loss:1.1418389157643394, Val loss:1.541609525680542, Test loss:1.5924803018569946
 Train acc:65.0282, Val acc:55.4972, Test acc:53.7996
Best Epoch 316,Val 55.7993, Test 54.1119

Epoch:340, avg epoch time:14.1730
 Train loss:1.1351001603262765, Val loss:1.5366212129592896, Test loss:1.585097312927246
 Train acc:65.1617, Val acc:55.6189, Test acc:53.8997
Best Epoch 327,Val 55.9179, Test 54.2693

Epoch:360, avg epoch time:14.1210
 Train loss:1.129436078525725, Val loss:1.5440340042114258, Test loss:1.595758080482483
 Train acc:65.3537, Val acc:55.4617, Test acc:53.5802
Best Epoch 327,Val 55.9179, Test 54.2693

Epoch:380, avg epoch time:14.0900
 Train loss:1.1202060608636766, Val loss:1.537517786026001, Test loss:1.5868254899978638
 Train acc:65.5135, Val acc:55.6790, Test acc:53.8139
Best Epoch 327,Val 55.9179, Test 54.2693

Epoch:400, avg epoch time:14.0417
 Train loss:1.1159253006889707, Val loss:1.555706262588501, Test loss:1.6062400341033936
 Train acc:65.6418, Val acc:55.5511, Test acc:53.7376
Best Epoch 327,Val 55.9179, Test 54.2693

Best Epoch 327, Val 55.9179, Test 54.2693
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:19,  3.73it/s]  3%|▎         | 2/74 [00:00<00:14,  5.08it/s]  4%|▍         | 3/74 [00:00<00:17,  4.02it/s]  5%|▌         | 4/74 [00:01<00:21,  3.29it/s]  7%|▋         | 5/74 [00:01<00:17,  3.98it/s]  8%|▊         | 6/74 [00:01<00:14,  4.54it/s]  9%|▉         | 7/74 [00:01<00:13,  4.85it/s] 11%|█         | 8/74 [00:01<00:13,  4.91it/s] 12%|█▏        | 9/74 [00:01<00:12,  5.22it/s] 14%|█▎        | 10/74 [00:02<00:11,  5.34it/s] 15%|█▍        | 11/74 [00:02<00:11,  5.34it/s] 16%|█▌        | 12/74 [00:02<00:10,  5.66it/s] 18%|█▊        | 13/74 [00:02<00:10,  5.67it/s] 19%|█▉        | 14/74 [00:03<00:14,  4.16it/s] 20%|██        | 15/74 [00:03<00:14,  3.97it/s] 22%|██▏       | 16/74 [00:03<00:13,  4.16it/s] 23%|██▎       | 17/74 [00:03<00:13,  4.22it/s] 24%|██▍       | 18/74 [00:04<00:13,  4.12it/s] 26%|██▌       | 19/74 [00:04<00:12,  4.26it/s] 27%|██▋       | 20/74 [00:04<00:12,  4.46it/s] 28%|██▊       | 21/74 [00:04<00:12,  4.36it/s] 30%|██▉       | 22/74 [00:04<00:11,  4.64it/s] 31%|███       | 23/74 [00:05<00:14,  3.43it/s] 32%|███▏      | 24/74 [00:05<00:13,  3.71it/s] 34%|███▍      | 25/74 [00:05<00:12,  3.89it/s] 35%|███▌      | 26/74 [00:06<00:11,  4.07it/s] 36%|███▋      | 27/74 [00:06<00:10,  4.29it/s] 38%|███▊      | 28/74 [00:06<00:09,  5.04it/s] 39%|███▉      | 29/74 [00:06<00:07,  5.83it/s] 41%|████      | 30/74 [00:06<00:07,  6.14it/s] 42%|████▏     | 31/74 [00:06<00:07,  5.89it/s] 43%|████▎     | 32/74 [00:06<00:06,  6.05it/s] 45%|████▍     | 33/74 [00:07<00:09,  4.53it/s] 46%|████▌     | 34/74 [00:07<00:09,  4.22it/s] 47%|████▋     | 35/74 [00:07<00:09,  4.32it/s] 49%|████▊     | 36/74 [00:07<00:08,  4.49it/s] 50%|█████     | 37/74 [00:08<00:07,  4.74it/s] 51%|█████▏    | 38/74 [00:08<00:07,  4.73it/s] 53%|█████▎    | 39/74 [00:08<00:07,  4.91it/s] 54%|█████▍    | 40/74 [00:08<00:06,  4.97it/s] 55%|█████▌    | 41/74 [00:08<00:06,  4.82it/s] 57%|█████▋    | 42/74 [00:09<00:09,  3.53it/s] 58%|█████▊    | 43/74 [00:09<00:08,  3.73it/s] 59%|█████▉    | 44/74 [00:09<00:06,  4.39it/s] 61%|██████    | 45/74 [00:09<00:06,  4.75it/s] 62%|██████▏   | 46/74 [00:10<00:05,  4.85it/s] 64%|██████▎   | 47/74 [00:10<00:05,  5.05it/s] 65%|██████▍   | 48/74 [00:10<00:05,  4.98it/s] 66%|██████▌   | 49/74 [00:10<00:05,  4.46it/s] 68%|██████▊   | 50/74 [00:10<00:04,  4.98it/s] 69%|██████▉   | 51/74 [00:11<00:04,  5.33it/s] 70%|███████   | 52/74 [00:11<00:05,  4.11it/s] 72%|███████▏  | 53/74 [00:11<00:05,  4.14it/s] 73%|███████▎  | 54/74 [00:11<00:04,  4.18it/s] 74%|███████▍  | 55/74 [00:12<00:04,  4.33it/s] 76%|███████▌  | 56/74 [00:12<00:03,  4.55it/s] 77%|███████▋  | 57/74 [00:12<00:03,  4.70it/s] 78%|███████▊  | 58/74 [00:12<00:03,  4.71it/s] 80%|███████▉  | 59/74 [00:12<00:03,  4.81it/s] 81%|████████  | 60/74 [00:13<00:02,  4.69it/s] 82%|████████▏ | 61/74 [00:13<00:03,  3.99it/s] 84%|████████▍ | 62/74 [00:13<00:02,  4.40it/s] 85%|████████▌ | 63/74 [00:13<00:02,  4.32it/s] 86%|████████▋ | 64/74 [00:14<00:02,  4.72it/s] 88%|████████▊ | 65/74 [00:14<00:01,  4.91it/s] 89%|████████▉ | 66/74 [00:14<00:01,  5.12it/s] 91%|█████████ | 67/74 [00:14<00:01,  5.05it/s] 92%|█████████▏| 68/74 [00:14<00:01,  5.47it/s] 93%|█████████▎| 69/74 [00:15<00:00,  5.46it/s] 95%|█████████▍| 70/74 [00:15<00:00,  5.49it/s] 96%|█████████▌| 71/74 [00:15<00:00,  4.09it/s] 97%|█████████▋| 72/74 [00:15<00:00,  4.34it/s] 99%|█████████▊| 73/74 [00:15<00:00,  4.72it/s]100%|██████████| 74/74 [00:16<00:00,  5.27it/s]100%|██████████| 74/74 [00:16<00:00,  4.60it/s]
Stage 1 

Stage 0 history model:
	Train acc 75.3372 Val acc 55.9179 Test acc 54.2693
Stage: 1, threshold 0.75, confident nodes: 37745 / 106818
		 val confident nodes: 23905 / 64879,  val confident level: 0.8012549877166748
		test confident nodes: 13840 / 41939, test confident_level: 0.7944363951683044
Current num label hops = 2
# Params: 11195425
Epoch:20, avg epoch time:16.1693
 Train loss:1.5528777570866827, Val loss:1.6330626010894775, Test loss:1.705761432647705
 Train acc:57.8137, Val acc:56.6824, Test acc:54.9345
Best Epoch 17,Val 56.8504, Test 55.0466

Epoch:40, avg epoch time:16.6587
 Train loss:1.3960403595397721, Val loss:1.6392613649368286, Test loss:1.714548945426941
 Train acc:60.1680, Val acc:57.2296, Test acc:55.6904
Best Epoch 39,Val 57.2296, Test 55.6904

Epoch:60, avg epoch time:17.4805
 Train loss:1.3111225242045388, Val loss:1.6632283926010132, Test loss:1.7568241357803345
 Train acc:61.6587, Val acc:57.3021, Test acc:55.4281
Best Epoch 51,Val 57.5810, Test 55.6928

Epoch:80, avg epoch time:17.8379
 Train loss:1.250707786474655, Val loss:1.6881344318389893, Test loss:1.7883542776107788
 Train acc:62.7505, Val acc:57.6119, Test acc:55.6523
Best Epoch 74,Val 57.9679, Test 55.9789

Epoch:100, avg epoch time:18.0743
 Train loss:1.208248412431176, Val loss:1.7046812772750854, Test loss:1.794288992881775
 Train acc:63.6499, Val acc:57.5394, Test acc:55.8835
Best Epoch 74,Val 57.9679, Test 55.9789

Epoch:120, avg epoch time:18.2178
 Train loss:1.1721826364744956, Val loss:1.7018892765045166, Test loss:1.791429042816162
 Train acc:64.3680, Val acc:57.5518, Test acc:55.6761
Best Epoch 74,Val 57.9679, Test 55.9789

Epoch:140, avg epoch time:18.5119
 Train loss:1.1437618252056747, Val loss:1.7174140214920044, Test loss:1.804516077041626
 Train acc:65.0159, Val acc:57.8662, Test acc:56.0242
Best Epoch 74,Val 57.9679, Test 55.9789

Epoch:160, avg epoch time:18.8940
 Train loss:1.1198786888549577, Val loss:1.7361031770706177, Test loss:1.8251436948776245
 Train acc:65.5357, Val acc:57.6411, Test acc:55.6976
Best Epoch 74,Val 57.9679, Test 55.9789

Best Epoch 74, Val 57.9679, Test 55.9789
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:22,  3.29it/s]  3%|▎         | 2/74 [00:00<00:21,  3.41it/s]  4%|▍         | 3/74 [00:00<00:20,  3.48it/s]  5%|▌         | 4/74 [00:01<00:20,  3.36it/s]  7%|▋         | 5/74 [00:01<00:23,  2.98it/s]  8%|▊         | 6/74 [00:01<00:18,  3.62it/s]  9%|▉         | 7/74 [00:01<00:17,  3.79it/s] 11%|█         | 8/74 [00:02<00:16,  3.96it/s] 12%|█▏        | 9/74 [00:02<00:16,  3.94it/s] 14%|█▎        | 10/74 [00:02<00:15,  4.00it/s] 15%|█▍        | 11/74 [00:02<00:15,  4.17it/s] 16%|█▌        | 12/74 [00:03<00:15,  4.04it/s] 18%|█▊        | 13/74 [00:03<00:15,  4.00it/s] 19%|█▉        | 14/74 [00:03<00:15,  3.91it/s] 20%|██        | 15/74 [00:04<00:19,  3.08it/s] 22%|██▏       | 16/74 [00:04<00:16,  3.50it/s] 23%|██▎       | 17/74 [00:04<00:16,  3.36it/s] 24%|██▍       | 18/74 [00:04<00:16,  3.48it/s] 26%|██▌       | 19/74 [00:05<00:15,  3.46it/s] 27%|██▋       | 20/74 [00:05<00:15,  3.56it/s] 28%|██▊       | 21/74 [00:05<00:14,  3.59it/s] 30%|██▉       | 22/74 [00:06<00:14,  3.69it/s] 31%|███       | 23/74 [00:06<00:13,  3.75it/s] 32%|███▏      | 24/74 [00:06<00:17,  2.86it/s] 34%|███▍      | 25/74 [00:07<00:16,  3.01it/s] 35%|███▌      | 26/74 [00:07<00:15,  3.05it/s] 36%|███▋      | 27/74 [00:07<00:14,  3.18it/s] 38%|███▊      | 28/74 [00:08<00:14,  3.27it/s] 39%|███▉      | 29/74 [00:08<00:13,  3.34it/s] 41%|████      | 30/74 [00:08<00:12,  3.47it/s] 42%|████▏     | 31/74 [00:08<00:12,  3.51it/s] 43%|████▎     | 32/74 [00:09<00:11,  3.64it/s] 45%|████▍     | 33/74 [00:09<00:10,  3.91it/s] 46%|████▌     | 34/74 [00:09<00:12,  3.18it/s] 47%|████▋     | 35/74 [00:10<00:12,  3.14it/s] 49%|████▊     | 36/74 [00:10<00:11,  3.20it/s] 50%|█████     | 37/74 [00:10<00:11,  3.26it/s] 51%|█████▏    | 38/74 [00:10<00:10,  3.36it/s] 53%|█████▎    | 39/74 [00:11<00:10,  3.35it/s] 54%|█████▍    | 40/74 [00:11<00:10,  3.34it/s] 55%|█████▌    | 41/74 [00:11<00:10,  3.22it/s] 57%|█████▋    | 42/74 [00:12<00:09,  3.28it/s] 58%|█████▊    | 43/74 [00:12<00:12,  2.42it/s] 59%|█████▉    | 44/74 [00:13<00:11,  2.58it/s] 61%|██████    | 45/74 [00:13<00:10,  2.77it/s] 62%|██████▏   | 46/74 [00:13<00:09,  2.99it/s] 64%|██████▎   | 47/74 [00:14<00:08,  3.10it/s] 65%|██████▍   | 48/74 [00:14<00:08,  3.20it/s] 66%|██████▌   | 49/74 [00:14<00:07,  3.28it/s] 68%|██████▊   | 50/74 [00:14<00:07,  3.39it/s] 69%|██████▉   | 51/74 [00:15<00:06,  3.52it/s] 70%|███████   | 52/74 [00:15<00:06,  3.53it/s] 72%|███████▏  | 53/74 [00:15<00:06,  3.04it/s] 73%|███████▎  | 54/74 [00:16<00:06,  3.23it/s] 74%|███████▍  | 55/74 [00:16<00:05,  3.24it/s] 76%|███████▌  | 56/74 [00:16<00:05,  3.48it/s] 77%|███████▋  | 57/74 [00:16<00:04,  3.79it/s] 78%|███████▊  | 58/74 [00:17<00:04,  3.88it/s] 80%|███████▉  | 59/74 [00:17<00:03,  3.94it/s] 81%|████████  | 60/74 [00:17<00:03,  4.01it/s] 82%|████████▏ | 61/74 [00:17<00:03,  4.16it/s] 84%|████████▍ | 62/74 [00:18<00:03,  3.38it/s] 85%|████████▌ | 63/74 [00:18<00:03,  3.58it/s] 86%|████████▋ | 64/74 [00:18<00:02,  3.60it/s] 88%|████████▊ | 65/74 [00:19<00:02,  3.67it/s] 89%|████████▉ | 66/74 [00:19<00:02,  3.56it/s] 91%|█████████ | 67/74 [00:19<00:01,  3.64it/s] 92%|█████████▏| 68/74 [00:19<00:01,  3.72it/s] 93%|█████████▎| 69/74 [00:20<00:01,  3.89it/s] 95%|█████████▍| 70/74 [00:20<00:01,  3.92it/s] 96%|█████████▌| 71/74 [00:20<00:00,  3.98it/s] 97%|█████████▋| 72/74 [00:21<00:00,  3.28it/s] 99%|█████████▊| 73/74 [00:21<00:00,  3.54it/s]100%|██████████| 74/74 [00:21<00:00,  3.95it/s]100%|██████████| 74/74 [00:21<00:00,  3.45it/s]
Stage 2 

Stage 1 history model:
	Train acc 68.2609 Val acc 57.9679 Test acc 55.9789
Stage: 2, threshold 0.75, confident nodes: 58841 / 106818
		 val confident nodes: 35893 / 64879,  val confident level: 0.7476945519447327
		test confident nodes: 22948 / 41939, test confident_level: 0.7239410877227783
Current num label hops = 2
# Params: 11195425
Epoch:20, avg epoch time:22.7986
 Train loss:1.6205842408581057, Val loss:1.7638664245605469, Test loss:1.8831087350845337
 Train acc:57.2688, Val acc:57.4546, Test acc:55.5378
Best Epoch 17,Val 57.6519, Test 55.8263

Epoch:40, avg epoch time:22.6591
 Train loss:1.450425614481387, Val loss:1.881704330444336, Test loss:2.0403339862823486
 Train acc:59.5134, Val acc:57.2173, Test acc:55.2588
Best Epoch 20,Val 57.7937, Test 55.7810

Epoch:60, avg epoch time:22.7265
 Train loss:1.3547330921974734, Val loss:1.8859641551971436, Test loss:2.061328172683716
 Train acc:60.9302, Val acc:57.7722, Test acc:56.0075
Best Epoch 55,Val 57.9910, Test 56.3294

Epoch:80, avg epoch time:22.9502
 Train loss:1.294275202612946, Val loss:1.929487705230713, Test loss:2.1131958961486816
 Train acc:61.9622, Val acc:57.7352, Test acc:55.9217
Best Epoch 77,Val 58.2900, Test 56.2937

Epoch:100, avg epoch time:22.9975
 Train loss:1.245995409246804, Val loss:1.93978750705719, Test loss:2.137321949005127
 Train acc:62.7613, Val acc:58.1190, Test acc:56.1005
Best Epoch 77,Val 58.2900, Test 56.2937

Epoch:120, avg epoch time:23.0461
 Train loss:1.211895429569742, Val loss:1.986972689628601, Test loss:2.1846251487731934
 Train acc:63.5320, Val acc:58.1806, Test acc:56.4010
Best Epoch 110,Val 58.4457, Test 56.6561

Epoch:140, avg epoch time:23.1323
 Train loss:1.1831731969031736, Val loss:2.003505229949951, Test loss:2.199990749359131
 Train acc:64.0137, Val acc:58.3949, Test acc:56.4963
Best Epoch 131,Val 58.4827, Test 56.6585

Epoch:160, avg epoch time:23.1139
 Train loss:1.1567495041999265, Val loss:2.039090633392334, Test loss:2.235340118408203
 Train acc:64.5322, Val acc:58.2577, Test acc:56.5035
Best Epoch 131,Val 58.4827, Test 56.6585

Epoch:180, avg epoch time:23.0975
 Train loss:1.135146305180978, Val loss:2.0899510383605957, Test loss:2.2956717014312744
 Train acc:65.0614, Val acc:58.4426, Test acc:56.7515
Best Epoch 174,Val 58.5582, Test 56.6275

Epoch:200, avg epoch time:23.0528
 Train loss:1.1188496437625608, Val loss:2.0953621864318848, Test loss:2.3103997707366943
 Train acc:65.3545, Val acc:58.4010, Test acc:56.5226
Best Epoch 174,Val 58.5582, Test 56.6275

Epoch:220, avg epoch time:22.8865
 Train loss:1.1009984102802, Val loss:2.0918962955474854, Test loss:2.2987732887268066
 Train acc:65.7818, Val acc:58.2777, Test acc:56.4963
Best Epoch 214,Val 58.6014, Test 56.5130

Epoch:240, avg epoch time:22.8776
 Train loss:1.0867873568465745, Val loss:2.0939183235168457, Test loss:2.3173093795776367
 Train acc:66.1215, Val acc:58.6060, Test acc:56.4010
Best Epoch 236,Val 58.6569, Test 56.6489

Epoch:260, avg epoch time:22.8510
 Train loss:1.0736941030060037, Val loss:2.1099138259887695, Test loss:2.3230721950531006
 Train acc:66.3296, Val acc:58.4488, Test acc:56.6489
Best Epoch 236,Val 58.6569, Test 56.6489

Epoch:280, avg epoch time:22.7883
 Train loss:1.0633930227030879, Val loss:2.162609577178955, Test loss:2.390746831893921
 Train acc:66.5774, Val acc:58.5659, Test acc:56.5703
Best Epoch 236,Val 58.6569, Test 56.6489

Epoch:300, avg epoch time:22.7453
 Train loss:1.0507098229035088, Val loss:2.1718688011169434, Test loss:2.4009323120117188
 Train acc:66.9148, Val acc:58.3841, Test acc:56.3342
Best Epoch 236,Val 58.6569, Test 56.6489

Epoch:320, avg epoch time:22.6720
 Train loss:1.0435298836749534, Val loss:2.152832269668579, Test loss:2.376931667327881
 Train acc:67.0474, Val acc:58.5675, Test acc:56.5035
Best Epoch 236,Val 58.6569, Test 56.6489

Best Epoch 236, Val 58.6569, Test 56.6489
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:15,  4.66it/s]  3%|▎         | 2/74 [00:00<00:15,  4.68it/s]  4%|▍         | 3/74 [00:00<00:15,  4.69it/s]  5%|▌         | 4/74 [00:00<00:15,  4.58it/s]  7%|▋         | 5/74 [00:01<00:15,  4.58it/s]  8%|▊         | 6/74 [00:01<00:14,  4.57it/s]  9%|▉         | 7/74 [00:01<00:13,  4.83it/s] 11%|█         | 8/74 [00:01<00:19,  3.37it/s] 12%|█▏        | 9/74 [00:02<00:17,  3.62it/s] 14%|█▎        | 10/74 [00:02<00:15,  4.06it/s] 15%|█▍        | 11/74 [00:02<00:16,  3.86it/s] 16%|█▌        | 12/74 [00:02<00:15,  3.89it/s] 18%|█▊        | 13/74 [00:03<00:16,  3.79it/s] 19%|█▉        | 14/74 [00:03<00:15,  3.95it/s] 20%|██        | 15/74 [00:03<00:14,  4.15it/s] 22%|██▏       | 16/74 [00:03<00:13,  4.26it/s] 23%|██▎       | 17/74 [00:04<00:16,  3.42it/s] 24%|██▍       | 18/74 [00:04<00:15,  3.51it/s] 26%|██▌       | 19/74 [00:04<00:14,  3.73it/s] 27%|██▋       | 20/74 [00:05<00:13,  3.97it/s] 28%|██▊       | 21/74 [00:05<00:14,  3.68it/s] 30%|██▉       | 22/74 [00:05<00:14,  3.47it/s] 31%|███       | 23/74 [00:05<00:14,  3.50it/s] 32%|███▏      | 24/74 [00:06<00:14,  3.53it/s] 34%|███▍      | 25/74 [00:06<00:13,  3.52it/s] 35%|███▌      | 26/74 [00:06<00:13,  3.46it/s] 36%|███▋      | 27/74 [00:07<00:16,  2.92it/s] 38%|███▊      | 28/74 [00:07<00:14,  3.21it/s] 39%|███▉      | 29/74 [00:07<00:13,  3.26it/s] 41%|████      | 30/74 [00:08<00:12,  3.51it/s] 42%|████▏     | 31/74 [00:08<00:11,  3.75it/s] 43%|████▎     | 32/74 [00:08<00:11,  3.71it/s] 45%|████▍     | 33/74 [00:08<00:11,  3.56it/s] 46%|████▌     | 34/74 [00:09<00:10,  3.81it/s] 47%|████▋     | 35/74 [00:09<00:10,  3.89it/s] 49%|████▊     | 36/74 [00:09<00:11,  3.40it/s] 50%|█████     | 37/74 [00:09<00:10,  3.46it/s] 51%|█████▏    | 38/74 [00:10<00:09,  3.62it/s] 53%|█████▎    | 39/74 [00:10<00:09,  3.51it/s] 54%|█████▍    | 40/74 [00:10<00:09,  3.51it/s] 55%|█████▌    | 41/74 [00:11<00:09,  3.57it/s] 57%|█████▋    | 42/74 [00:11<00:08,  3.69it/s] 58%|█████▊    | 43/74 [00:11<00:08,  3.81it/s] 59%|█████▉    | 44/74 [00:11<00:07,  3.77it/s] 61%|██████    | 45/74 [00:12<00:07,  3.90it/s] 62%|██████▏   | 46/74 [00:12<00:08,  3.34it/s] 64%|██████▎   | 47/74 [00:12<00:07,  3.41it/s] 65%|██████▍   | 48/74 [00:12<00:06,  3.76it/s] 66%|██████▌   | 49/74 [00:13<00:06,  3.92it/s] 68%|██████▊   | 50/74 [00:13<00:05,  4.12it/s] 69%|██████▉   | 51/74 [00:13<00:05,  4.22it/s] 70%|███████   | 52/74 [00:13<00:04,  4.45it/s] 72%|███████▏  | 53/74 [00:14<00:04,  4.54it/s] 73%|███████▎  | 54/74 [00:14<00:04,  4.58it/s] 74%|███████▍  | 55/74 [00:14<00:05,  3.68it/s] 76%|███████▌  | 56/74 [00:14<00:04,  3.83it/s] 77%|███████▋  | 57/74 [00:15<00:04,  3.91it/s] 78%|███████▊  | 58/74 [00:15<00:03,  4.00it/s] 80%|███████▉  | 59/74 [00:15<00:03,  4.15it/s] 81%|████████  | 60/74 [00:15<00:03,  4.37it/s] 82%|████████▏ | 61/74 [00:15<00:02,  4.48it/s] 84%|████████▍ | 62/74 [00:16<00:02,  4.56it/s] 85%|████████▌ | 63/74 [00:16<00:02,  4.64it/s] 86%|████████▋ | 64/74 [00:16<00:02,  4.73it/s] 88%|████████▊ | 65/74 [00:17<00:02,  3.71it/s] 89%|████████▉ | 66/74 [00:17<00:02,  3.90it/s] 91%|█████████ | 67/74 [00:17<00:01,  3.79it/s] 92%|█████████▏| 68/74 [00:17<00:01,  3.75it/s] 93%|█████████▎| 69/74 [00:18<00:01,  3.73it/s] 95%|█████████▍| 70/74 [00:18<00:01,  3.86it/s] 96%|█████████▌| 71/74 [00:18<00:00,  4.08it/s] 97%|█████████▋| 72/74 [00:18<00:00,  4.14it/s] 99%|█████████▊| 73/74 [00:18<00:00,  4.20it/s]100%|██████████| 74/74 [00:19<00:00,  3.59it/s]100%|██████████| 74/74 [00:19<00:00,  3.83it/s]
Stage 3 

Stage 2 history model:
	Train acc 74.2799 Val acc 58.6569 Test acc 56.6489
Stage: 3, threshold 0.75, confident nodes: 72443 / 106818
		 val confident nodes: 43854 / 64879,  val confident level: 0.70709627866745
		test confident nodes: 28589 / 41939, test confident_level: 0.6769037246704102
Current num label hops = 2
# Params: 11195425
Epoch:20, avg epoch time:21.0310
 Train loss:1.7234380614589637, Val loss:1.79379141330719, Test loss:1.9279817342758179
 Train acc:56.8997, Val acc:57.9957, Test acc:56.3104
Best Epoch 19,Val 57.9957, Test 56.3104

Epoch:40, avg epoch time:21.1986
 Train loss:1.5284399734416478, Val loss:1.9191627502441406, Test loss:2.109760284423828
 Train acc:58.8628, Val acc:58.1945, Test acc:56.1482
Best Epoch 20,Val 58.2392, Test 56.2364

Epoch:60, avg epoch time:21.2942
 Train loss:1.4260373182699715, Val loss:2.0433013439178467, Test loss:2.2694263458251953
 Train acc:60.2048, Val acc:58.1405, Test acc:56.1530
Best Epoch 41,Val 58.3825, Test 56.4248

Epoch:80, avg epoch time:21.3573
 Train loss:1.351832154770972, Val loss:2.1173853874206543, Test loss:2.35929012298584
 Train acc:61.2504, Val acc:58.3979, Test acc:56.5083
Best Epoch 77,Val 58.4134, Test 56.4081

Epoch:100, avg epoch time:21.4289
 Train loss:1.308136715015895, Val loss:2.1791844367980957, Test loss:2.4414215087890625
 Train acc:61.8907, Val acc:58.3717, Test acc:56.4105
Best Epoch 97,Val 58.5151, Test 56.5774

Epoch:120, avg epoch time:21.4269
 Train loss:1.2668293731313356, Val loss:2.209090232849121, Test loss:2.472144603729248
 Train acc:62.5820, Val acc:58.4118, Test acc:56.5583
Best Epoch 117,Val 58.6106, Test 56.6489

Epoch:140, avg epoch time:21.4557
 Train loss:1.2396724140140372, Val loss:2.2166755199432373, Test loss:2.4815595149993896
 Train acc:63.0440, Val acc:58.4935, Test acc:56.6156
Best Epoch 117,Val 58.6106, Test 56.6489

Epoch:160, avg epoch time:21.4821
 Train loss:1.2108872071118422, Val loss:2.2876713275909424, Test loss:2.557081699371338
 Train acc:63.5457, Val acc:58.4442, Test acc:56.6990
Best Epoch 117,Val 58.6106, Test 56.6489

Epoch:180, avg epoch time:21.4677
 Train loss:1.1885870812644421, Val loss:2.2622270584106445, Test loss:2.5381224155426025
 Train acc:63.9804, Val acc:58.5582, Test acc:56.5822
Best Epoch 166,Val 58.7417, Test 56.8468

Epoch:200, avg epoch time:21.4503
 Train loss:1.1662024494627832, Val loss:2.3181188106536865, Test loss:2.607947826385498
 Train acc:64.4442, Val acc:58.4550, Test acc:56.6203
Best Epoch 166,Val 58.7417, Test 56.8468

Epoch:220, avg epoch time:21.4387
 Train loss:1.1539691669840209, Val loss:2.4370956420898438, Test loss:2.738597869873047
 Train acc:64.6648, Val acc:58.4658, Test acc:56.7539
Best Epoch 166,Val 58.7417, Test 56.8468

Epoch:240, avg epoch time:21.4616
 Train loss:1.1340524831288297, Val loss:2.3386082649230957, Test loss:2.6371591091156006
 Train acc:65.0978, Val acc:58.6877, Test acc:56.7229
Best Epoch 166,Val 58.7417, Test 56.8468

Epoch:260, avg epoch time:21.4913
 Train loss:1.1219253859049838, Val loss:2.360825300216675, Test loss:2.6504547595977783
 Train acc:65.4231, Val acc:58.5120, Test acc:56.7276
Best Epoch 166,Val 58.7417, Test 56.8468

Best Epoch 166, Val 58.7417, Test 56.8468
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:18,  3.99it/s]  3%|▎         | 2/74 [00:00<00:23,  3.13it/s]  4%|▍         | 3/74 [00:00<00:21,  3.28it/s]  5%|▌         | 4/74 [00:01<00:17,  4.11it/s]  7%|▋         | 5/74 [00:01<00:13,  4.96it/s]  8%|▊         | 6/74 [00:01<00:13,  4.93it/s]  9%|▉         | 7/74 [00:01<00:13,  4.87it/s] 11%|█         | 8/74 [00:01<00:14,  4.40it/s] 12%|█▏        | 9/74 [00:02<00:16,  3.89it/s] 14%|█▎        | 10/74 [00:02<00:16,  3.97it/s] 15%|█▍        | 11/74 [00:02<00:21,  2.91it/s] 16%|█▌        | 12/74 [00:03<00:19,  3.24it/s] 18%|█▊        | 13/74 [00:03<00:17,  3.56it/s] 19%|█▉        | 14/74 [00:03<00:16,  3.60it/s] 20%|██        | 15/74 [00:03<00:16,  3.63it/s] 22%|██▏       | 16/74 [00:04<00:15,  3.75it/s] 23%|██▎       | 17/74 [00:04<00:14,  4.00it/s] 24%|██▍       | 18/74 [00:04<00:14,  3.97it/s] 26%|██▌       | 19/74 [00:04<00:14,  3.78it/s] 27%|██▋       | 20/74 [00:05<00:13,  3.89it/s] 28%|██▊       | 21/74 [00:05<00:16,  3.16it/s] 30%|██▉       | 22/74 [00:05<00:15,  3.37it/s] 31%|███       | 23/74 [00:06<00:14,  3.54it/s] 32%|███▏      | 24/74 [00:06<00:13,  3.78it/s] 34%|███▍      | 25/74 [00:06<00:12,  3.90it/s] 35%|███▌      | 26/74 [00:06<00:11,  4.13it/s] 36%|███▋      | 27/74 [00:07<00:11,  4.10it/s] 38%|███▊      | 28/74 [00:07<00:10,  4.26it/s] 39%|███▉      | 29/74 [00:07<00:10,  4.47it/s] 41%|████      | 30/74 [00:07<00:12,  3.61it/s] 42%|████▏     | 31/74 [00:08<00:11,  3.70it/s] 43%|████▎     | 32/74 [00:08<00:10,  3.87it/s] 45%|████▍     | 33/74 [00:08<00:09,  4.15it/s] 46%|████▌     | 34/74 [00:08<00:09,  4.40it/s] 47%|████▋     | 35/74 [00:09<00:08,  4.45it/s] 49%|████▊     | 36/74 [00:09<00:08,  4.49it/s] 50%|█████     | 37/74 [00:09<00:08,  4.41it/s] 51%|█████▏    | 38/74 [00:09<00:08,  4.37it/s] 53%|█████▎    | 39/74 [00:09<00:07,  4.46it/s] 54%|█████▍    | 40/74 [00:10<00:09,  3.55it/s] 55%|█████▌    | 41/74 [00:10<00:08,  3.86it/s] 57%|█████▋    | 42/74 [00:10<00:07,  4.09it/s] 58%|█████▊    | 43/74 [00:10<00:07,  4.26it/s] 59%|█████▉    | 44/74 [00:11<00:06,  4.37it/s] 61%|██████    | 45/74 [00:11<00:06,  4.26it/s] 62%|██████▏   | 46/74 [00:11<00:06,  4.13it/s] 64%|██████▎   | 47/74 [00:11<00:06,  4.18it/s] 65%|██████▍   | 48/74 [00:12<00:06,  3.90it/s] 66%|██████▌   | 49/74 [00:12<00:07,  3.17it/s] 68%|██████▊   | 50/74 [00:12<00:07,  3.22it/s] 69%|██████▉   | 51/74 [00:13<00:06,  3.39it/s] 70%|███████   | 52/74 [00:13<00:06,  3.58it/s] 72%|███████▏  | 53/74 [00:13<00:05,  3.68it/s] 73%|███████▎  | 54/74 [00:13<00:05,  3.75it/s] 74%|███████▍  | 55/74 [00:14<00:04,  4.11it/s] 76%|███████▌  | 56/74 [00:14<00:04,  4.38it/s] 77%|███████▋  | 57/74 [00:14<00:03,  4.30it/s] 78%|███████▊  | 58/74 [00:14<00:03,  4.00it/s] 80%|███████▉  | 59/74 [00:15<00:04,  3.47it/s] 81%|████████  | 60/74 [00:15<00:03,  3.54it/s] 82%|████████▏ | 61/74 [00:15<00:03,  3.68it/s] 84%|████████▍ | 62/74 [00:16<00:03,  3.76it/s] 85%|████████▌ | 63/74 [00:16<00:02,  3.88it/s] 86%|████████▋ | 64/74 [00:16<00:02,  3.91it/s] 88%|████████▊ | 65/74 [00:16<00:02,  3.93it/s] 89%|████████▉ | 66/74 [00:17<00:02,  3.98it/s] 91%|█████████ | 67/74 [00:17<00:01,  4.04it/s] 92%|█████████▏| 68/74 [00:17<00:01,  3.13it/s] 93%|█████████▎| 69/74 [00:18<00:01,  2.98it/s] 95%|█████████▍| 70/74 [00:18<00:01,  2.93it/s] 96%|█████████▌| 71/74 [00:18<00:00,  3.18it/s] 97%|█████████▋| 72/74 [00:18<00:00,  3.40it/s] 99%|█████████▊| 73/74 [00:19<00:00,  3.53it/s]100%|██████████| 74/74 [00:19<00:00,  3.88it/s]100%|██████████| 74/74 [00:19<00:00,  3.81it/s]
