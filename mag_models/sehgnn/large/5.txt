Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.2.5, while the latest version is 1.3.3.
Namespace(seed=1, dataset='ogbn-mag', gpu=0, root='../data/', emb_path='../data/', stages=[400, 400, 400, 400], extra_embedding='complex', embed_size=256, num_hops=2, label_feats=True, num_label_hops=2, hidden=512, dropout=0.5, n_layers_1=2, n_layers_2=2, n_layers_3=4, input_drop=0.1, att_drop=0.0, label_drop=0.0, residual=True, act='leaky_relu', bns=True, label_bns=True, amp=True, lr=0.0005, weight_decay=0.0, eval_every=1, batch_size=10000, patience=100, threshold=0.75, gama=10.0, start_stage=0, reload='', moving_k=1, store_model=False, moe_widget=['feat_ngnn', 'label_ngnn'], num_expert=1, top_k=1, expert_drop=0.0, gate='naive')
Use extra embeddings generated with the complex method
Current num hops = 2
./output/ogbn-mag/5847419995a446c6b1496cce9a02e744 

Stage 0 

Current num label hops = 2
# Params: 8633887
Epoch:20, avg epoch time:17.2758
 Train loss:1.672604488948035, Val loss:1.667384147644043, Test loss:1.7049306631088257
 Train acc:54.6147, Val acc:52.7151, Test acc:51.4724
Best Epoch 17,Val 52.7598, Test 51.4581

Epoch:40, avg epoch time:16.8757
 Train loss:1.528198450330704, Val loss:1.6099361181259155, Test loss:1.6511526107788086
 Train acc:57.0959, Val acc:53.5104, Test acc:52.1305
Best Epoch 37,Val 54.0560, Test 52.7504

Epoch:60, avg epoch time:16.6606
 Train loss:1.4510597387949626, Val loss:1.5640653371810913, Test loss:1.6084132194519043
 Train acc:58.4639, Val acc:54.5446, Test acc:53.0246
Best Epoch 59,Val 54.5446, Test 53.0246

Epoch:80, avg epoch time:16.6837
 Train loss:1.4002546166616774, Val loss:1.564619541168213, Test loss:1.6085050106048584
 Train acc:59.4630, Val acc:54.4629, Test acc:52.8196
Best Epoch 78,Val 54.8128, Test 53.3227

Epoch:100, avg epoch time:16.6823
 Train loss:1.3638570952037024, Val loss:1.557654619216919, Test loss:1.6005851030349731
 Train acc:60.1756, Val acc:54.4783, Test acc:53.0604
Best Epoch 96,Val 55.1658, Test 53.5850

Epoch:120, avg epoch time:16.6099
 Train loss:1.3344999778838385, Val loss:1.5359454154968262, Test loss:1.585263729095459
 Train acc:60.7607, Val acc:55.1704, Test acc:53.3227
Best Epoch 114,Val 55.2567, Test 53.5683

Epoch:140, avg epoch time:16.5701
 Train loss:1.3108045146578835, Val loss:1.5408071279525757, Test loss:1.5874359607696533
 Train acc:61.3224, Val acc:54.9931, Test acc:53.3465
Best Epoch 127,Val 55.3292, Test 53.7090

Epoch:160, avg epoch time:16.5430
 Train loss:1.289247193033733, Val loss:1.5315479040145874, Test loss:1.5800151824951172
 Train acc:61.7535, Val acc:55.2983, Test acc:53.6875
Best Epoch 150,Val 55.4756, Test 53.7352

Epoch:180, avg epoch time:16.5423
 Train loss:1.271183865410941, Val loss:1.531826138496399, Test loss:1.5800541639328003
 Train acc:62.1580, Val acc:55.3107, Test acc:53.4753
Best Epoch 150,Val 55.4756, Test 53.7352

Epoch:200, avg epoch time:16.4791
 Train loss:1.2557554604515198, Val loss:1.5417215824127197, Test loss:1.5889320373535156
 Train acc:62.5324, Val acc:54.9808, Test acc:53.2726
Best Epoch 150,Val 55.4756, Test 53.7352

Epoch:220, avg epoch time:16.4771
 Train loss:1.2406292510411097, Val loss:1.5318788290023804, Test loss:1.5760421752929688
 Train acc:62.7775, Val acc:55.4170, Test acc:53.8115
Best Epoch 150,Val 55.4756, Test 53.7352

Epoch:240, avg epoch time:16.4464
 Train loss:1.22974617708297, Val loss:1.5287246704101562, Test loss:1.573099136352539
 Train acc:63.0474, Val acc:55.3615, Test acc:53.7495
Best Epoch 229,Val 55.5172, Test 53.8997

Epoch:260, avg epoch time:16.4300
 Train loss:1.2176191163441492, Val loss:1.5413317680358887, Test loss:1.586901307106018
 Train acc:63.3328, Val acc:55.1211, Test acc:53.5158
Best Epoch 244,Val 55.7284, Test 54.0189

Epoch:280, avg epoch time:16.4404
 Train loss:1.2088124960187883, Val loss:1.5258891582489014, Test loss:1.5725382566452026
 Train acc:63.4480, Val acc:55.5943, Test acc:53.9927
Best Epoch 244,Val 55.7284, Test 54.0189

Epoch:300, avg epoch time:16.3710
 Train loss:1.1974845197465684, Val loss:1.544245719909668, Test loss:1.5947984457015991
 Train acc:63.7677, Val acc:55.1118, Test acc:53.2416
Best Epoch 244,Val 55.7284, Test 54.0189

Epoch:320, avg epoch time:16.3344
 Train loss:1.1877419437680925, Val loss:1.5288196802139282, Test loss:1.5707415342330933
 Train acc:63.9874, Val acc:55.5218, Test acc:53.9188
Best Epoch 244,Val 55.7284, Test 54.0189

Epoch:340, avg epoch time:16.3182
 Train loss:1.181239608734373, Val loss:1.5405384302139282, Test loss:1.5863239765167236
 Train acc:64.1434, Val acc:55.4725, Test acc:53.7328
Best Epoch 322,Val 55.8070, Test 53.8306

Epoch:360, avg epoch time:16.2854
 Train loss:1.1754003214457678, Val loss:1.5295119285583496, Test loss:1.5755704641342163
 Train acc:64.3378, Val acc:55.5526, Test acc:53.9379
Best Epoch 354,Val 55.8440, Test 54.0833

Epoch:380, avg epoch time:16.2807
 Train loss:1.1663327860453772, Val loss:1.5493760108947754, Test loss:1.5960251092910767
 Train acc:64.5120, Val acc:55.0779, Test acc:53.3275
Best Epoch 354,Val 55.8440, Test 54.0833

Epoch:400, avg epoch time:16.2479
 Train loss:1.160406201604813, Val loss:1.5376520156860352, Test loss:1.5854567289352417
 Train acc:64.6037, Val acc:55.5357, Test acc:53.8258
Best Epoch 387,Val 55.8825, Test 53.9259

Best Epoch 387, Val 55.8825, Test 53.9259
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:21,  3.38it/s]  3%|▎         | 2/74 [00:00<00:20,  3.52it/s]  4%|▍         | 3/74 [00:00<00:18,  3.75it/s]  5%|▌         | 4/74 [00:01<00:22,  3.16it/s]  7%|▋         | 5/74 [00:01<00:19,  3.51it/s]  8%|▊         | 6/74 [00:01<00:18,  3.72it/s]  9%|▉         | 7/74 [00:01<00:16,  4.10it/s] 11%|█         | 8/74 [00:02<00:16,  3.96it/s] 12%|█▏        | 9/74 [00:02<00:15,  4.21it/s] 14%|█▎        | 10/74 [00:02<00:13,  4.82it/s] 15%|█▍        | 11/74 [00:02<00:12,  5.06it/s] 16%|█▌        | 12/74 [00:02<00:11,  5.51it/s] 18%|█▊        | 13/74 [00:02<00:11,  5.50it/s] 19%|█▉        | 14/74 [00:03<00:12,  4.77it/s] 20%|██        | 15/74 [00:03<00:12,  4.88it/s] 22%|██▏       | 16/74 [00:03<00:11,  5.22it/s] 23%|██▎       | 17/74 [00:03<00:12,  4.58it/s] 24%|██▍       | 18/74 [00:04<00:11,  4.78it/s] 26%|██▌       | 19/74 [00:04<00:10,  5.09it/s] 27%|██▋       | 20/74 [00:04<00:11,  4.84it/s] 28%|██▊       | 21/74 [00:04<00:11,  4.50it/s] 30%|██▉       | 22/74 [00:05<00:12,  4.06it/s] 31%|███       | 23/74 [00:05<00:14,  3.45it/s] 32%|███▏      | 24/74 [00:05<00:12,  4.02it/s] 34%|███▍      | 25/74 [00:05<00:11,  4.25it/s] 35%|███▌      | 26/74 [00:05<00:10,  4.47it/s] 36%|███▋      | 27/74 [00:06<00:09,  4.78it/s] 38%|███▊      | 28/74 [00:06<00:10,  4.45it/s] 39%|███▉      | 29/74 [00:06<00:08,  5.02it/s] 41%|████      | 30/74 [00:06<00:08,  5.30it/s] 42%|████▏     | 31/74 [00:06<00:08,  4.89it/s] 43%|████▎     | 32/74 [00:07<00:08,  4.99it/s] 45%|████▍     | 33/74 [00:07<00:10,  4.08it/s] 46%|████▌     | 34/74 [00:07<00:09,  4.10it/s] 47%|████▋     | 35/74 [00:08<00:09,  4.07it/s] 49%|████▊     | 36/74 [00:08<00:09,  3.92it/s] 50%|█████     | 37/74 [00:08<00:09,  4.11it/s] 51%|█████▏    | 38/74 [00:08<00:08,  4.27it/s] 53%|█████▎    | 39/74 [00:08<00:08,  4.25it/s] 54%|█████▍    | 40/74 [00:09<00:07,  4.44it/s] 55%|█████▌    | 41/74 [00:09<00:07,  4.33it/s] 57%|█████▋    | 42/74 [00:09<00:09,  3.43it/s] 58%|█████▊    | 43/74 [00:09<00:07,  4.00it/s] 59%|█████▉    | 44/74 [00:10<00:07,  3.99it/s] 61%|██████    | 45/74 [00:10<00:07,  4.00it/s] 62%|██████▏   | 46/74 [00:10<00:06,  4.29it/s] 64%|██████▎   | 47/74 [00:10<00:06,  3.92it/s] 65%|██████▍   | 48/74 [00:11<00:06,  4.21it/s] 66%|██████▌   | 49/74 [00:11<00:05,  4.41it/s] 68%|██████▊   | 50/74 [00:11<00:05,  4.28it/s] 69%|██████▉   | 51/74 [00:11<00:05,  4.22it/s] 70%|███████   | 52/74 [00:12<00:06,  3.57it/s] 72%|███████▏  | 53/74 [00:12<00:06,  3.44it/s] 73%|███████▎  | 54/74 [00:12<00:05,  3.78it/s] 74%|███████▍  | 55/74 [00:13<00:04,  3.86it/s] 76%|███████▌  | 56/74 [00:13<00:04,  4.19it/s] 77%|███████▋  | 57/74 [00:13<00:03,  4.65it/s] 78%|███████▊  | 58/74 [00:13<00:03,  4.72it/s] 80%|███████▉  | 59/74 [00:13<00:02,  5.04it/s] 81%|████████  | 60/74 [00:13<00:02,  5.90it/s] 82%|████████▏ | 61/74 [00:13<00:02,  6.16it/s] 85%|████████▌ | 63/74 [00:14<00:01,  8.38it/s] 88%|████████▊ | 65/74 [00:14<00:01,  8.50it/s] 89%|████████▉ | 66/74 [00:14<00:01,  7.37it/s] 92%|█████████▏| 68/74 [00:15<00:01,  5.42it/s] 93%|█████████▎| 69/74 [00:15<00:00,  5.04it/s] 95%|█████████▍| 70/74 [00:15<00:00,  4.35it/s] 96%|█████████▌| 71/74 [00:16<00:00,  3.31it/s] 97%|█████████▋| 72/74 [00:16<00:00,  3.28it/s] 99%|█████████▊| 73/74 [00:16<00:00,  3.02it/s]100%|██████████| 74/74 [00:17<00:00,  3.25it/s]100%|██████████| 74/74 [00:17<00:00,  4.32it/s]
Stage 1 

Stage 0 history model:
	Train acc 73.9856 Val acc 55.8825 Test acc 53.9259
Stage: 1, threshold 0.75, confident nodes: 36015 / 106818
		 val confident nodes: 22799 / 64879,  val confident level: 0.8089828491210938
		test confident nodes: 13216 / 41939, test confident_level: 0.7976694703102112
Current num label hops = 2
# Params: 11720737
Epoch:20, avg epoch time:20.7282
 Train loss:1.6609556425863237, Val loss:1.6414507627487183, Test loss:1.7035601139068604
 Train acc:56.3717, Val acc:56.2339, Test acc:54.5173
Best Epoch 18,Val 56.3634, Test 54.5459

Epoch:40, avg epoch time:21.0717
 Train loss:1.4799103754669873, Val loss:1.6252788305282593, Test loss:1.6997416019439697
 Train acc:58.8810, Val acc:56.8057, Test acc:54.9250
Best Epoch 35,Val 56.9845, Test 55.0418

Epoch:60, avg epoch time:21.1702
 Train loss:1.3879684619049528, Val loss:1.6205854415893555, Test loss:1.7050526142120361
 Train acc:60.3479, Val acc:57.3406, Test acc:55.4973
Best Epoch 58,Val 57.4654, Test 55.5974

Epoch:80, avg epoch time:21.1427
 Train loss:1.3250584157545175, Val loss:1.6331026554107666, Test loss:1.7239679098129272
 Train acc:61.4164, Val acc:57.3699, Test acc:55.2684
Best Epoch 74,Val 57.5363, Test 55.5450

Epoch:100, avg epoch time:21.1751
 Train loss:1.2765911799758227, Val loss:1.6587474346160889, Test loss:1.7574745416641235
 Train acc:62.2767, Val acc:57.1926, Test acc:55.1921
Best Epoch 92,Val 57.6658, Test 55.5354

Epoch:120, avg epoch time:21.1342
 Train loss:1.2408300994047479, Val loss:1.676171898841858, Test loss:1.7723668813705444
 Train acc:62.9684, Val acc:57.1495, Test acc:55.3757
Best Epoch 106,Val 57.7937, Test 55.6618

Epoch:140, avg epoch time:21.2790
 Train loss:1.2076159573313017, Val loss:1.6656701564788818, Test loss:1.7615715265274048
 Train acc:63.6897, Val acc:57.6704, Test acc:55.7715
Best Epoch 106,Val 57.7937, Test 55.6618

Epoch:160, avg epoch time:21.3199
 Train loss:1.1829688638003903, Val loss:1.7057437896728516, Test loss:1.8019862174987793
 Train acc:64.1994, Val acc:57.5348, Test acc:55.6308
Best Epoch 151,Val 57.8122, Test 55.7286

Epoch:180, avg epoch time:21.2867
 Train loss:1.163462676219086, Val loss:1.688947081565857, Test loss:1.7842313051223755
 Train acc:64.5525, Val acc:57.5502, Test acc:55.3137
Best Epoch 151,Val 57.8122, Test 55.7286

Epoch:200, avg epoch time:21.3231
 Train loss:1.1409253807210211, Val loss:1.714966893196106, Test loss:1.8107128143310547
 Train acc:65.1509, Val acc:57.5394, Test acc:55.3924
Best Epoch 151,Val 57.8122, Test 55.7286

Epoch:220, avg epoch time:21.3279
 Train loss:1.1225948226985647, Val loss:1.7238439321517944, Test loss:1.8151522874832153
 Train acc:65.5040, Val acc:57.6165, Test acc:55.5807
Best Epoch 151,Val 57.8122, Test 55.7286

Epoch:240, avg epoch time:21.3479
 Train loss:1.1063305833446446, Val loss:1.7119723558425903, Test loss:1.8090239763259888
 Train acc:65.9103, Val acc:57.8323, Test acc:55.6308
Best Epoch 237,Val 57.8970, Test 55.7071

Epoch:260, avg epoch time:21.3716
 Train loss:1.0918568942084241, Val loss:1.7337692975997925, Test loss:1.826135516166687
 Train acc:66.1875, Val acc:57.8122, Test acc:55.9050
Best Epoch 243,Val 57.9309, Test 55.8573

Epoch:280, avg epoch time:21.3975
 Train loss:1.077210310679763, Val loss:1.7429274320602417, Test loss:1.835107445716858
 Train acc:66.4635, Val acc:57.7876, Test acc:55.9050
Best Epoch 266,Val 58.0280, Test 56.1411

Epoch:300, avg epoch time:21.4261
 Train loss:1.0680352840850602, Val loss:1.750230312347412, Test loss:1.8429100513458252
 Train acc:66.7134, Val acc:57.6566, Test acc:55.7786
Best Epoch 266,Val 58.0280, Test 56.1411

Epoch:320, avg epoch time:21.4390
 Train loss:1.0573276032262773, Val loss:1.7571094036102295, Test loss:1.8510675430297852
 Train acc:67.0009, Val acc:57.7629, Test acc:55.8072
Best Epoch 266,Val 58.0280, Test 56.1411

Epoch:340, avg epoch time:21.4577
 Train loss:1.044962610771407, Val loss:1.7734646797180176, Test loss:1.8665670156478882
 Train acc:67.2825, Val acc:57.6365, Test acc:55.5903
Best Epoch 266,Val 58.0280, Test 56.1411

Epoch:360, avg epoch time:21.4590
 Train loss:1.0358302459787967, Val loss:1.7706609964370728, Test loss:1.8669581413269043
 Train acc:67.4647, Val acc:57.6350, Test acc:55.6666
Best Epoch 266,Val 58.0280, Test 56.1411

Best Epoch 266, Val 58.0280, Test 56.1411
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:15,  4.65it/s]  3%|▎         | 2/74 [00:00<00:15,  4.56it/s]  4%|▍         | 3/74 [00:00<00:18,  3.76it/s]  5%|▌         | 4/74 [00:00<00:16,  4.21it/s]  7%|▋         | 5/74 [00:01<00:18,  3.70it/s]  8%|▊         | 6/74 [00:01<00:17,  3.97it/s]  9%|▉         | 7/74 [00:01<00:17,  3.91it/s] 11%|█         | 8/74 [00:02<00:16,  3.93it/s] 12%|█▏        | 9/74 [00:02<00:16,  3.97it/s] 14%|█▎        | 10/74 [00:02<00:14,  4.48it/s] 15%|█▍        | 11/74 [00:02<00:14,  4.25it/s] 16%|█▌        | 12/74 [00:02<00:14,  4.15it/s] 18%|█▊        | 13/74 [00:03<00:13,  4.42it/s] 19%|█▉        | 14/74 [00:03<00:14,  4.08it/s] 20%|██        | 15/74 [00:03<00:17,  3.30it/s] 22%|██▏       | 16/74 [00:04<00:15,  3.77it/s] 23%|██▎       | 17/74 [00:04<00:16,  3.40it/s] 24%|██▍       | 18/74 [00:04<00:14,  3.84it/s] 26%|██▌       | 19/74 [00:04<00:14,  3.67it/s] 27%|██▋       | 20/74 [00:05<00:13,  3.86it/s] 28%|██▊       | 21/74 [00:05<00:13,  3.95it/s] 30%|██▉       | 22/74 [00:05<00:12,  4.24it/s] 31%|███       | 23/74 [00:05<00:12,  4.22it/s] 32%|███▏      | 24/74 [00:06<00:13,  3.68it/s] 34%|███▍      | 25/74 [00:06<00:13,  3.67it/s] 35%|███▌      | 26/74 [00:06<00:12,  3.82it/s] 36%|███▋      | 27/74 [00:07<00:13,  3.42it/s] 38%|███▊      | 28/74 [00:07<00:14,  3.12it/s] 39%|███▉      | 29/74 [00:07<00:13,  3.32it/s] 41%|████      | 30/74 [00:07<00:11,  3.84it/s] 42%|████▏     | 31/74 [00:08<00:11,  3.89it/s] 43%|████▎     | 32/74 [00:08<00:10,  3.90it/s] 45%|████▍     | 33/74 [00:08<00:12,  3.25it/s] 46%|████▌     | 34/74 [00:09<00:13,  2.98it/s] 47%|████▋     | 35/74 [00:09<00:12,  3.20it/s] 49%|████▊     | 36/74 [00:09<00:11,  3.37it/s] 50%|█████     | 37/74 [00:09<00:10,  3.39it/s] 51%|█████▏    | 38/74 [00:10<00:10,  3.43it/s] 53%|█████▎    | 39/74 [00:10<00:10,  3.30it/s] 54%|█████▍    | 40/74 [00:10<00:10,  3.35it/s] 55%|█████▌    | 41/74 [00:11<00:10,  3.20it/s] 57%|█████▋    | 42/74 [00:11<00:09,  3.20it/s] 58%|█████▊    | 43/74 [00:11<00:10,  3.00it/s] 59%|█████▉    | 44/74 [00:12<00:10,  2.99it/s] 61%|██████    | 45/74 [00:12<00:09,  3.21it/s] 62%|██████▏   | 46/74 [00:12<00:08,  3.46it/s] 64%|██████▎   | 47/74 [00:12<00:07,  3.58it/s] 65%|██████▍   | 48/74 [00:13<00:06,  3.84it/s] 66%|██████▌   | 49/74 [00:13<00:06,  3.70it/s] 68%|██████▊   | 50/74 [00:13<00:05,  4.09it/s] 69%|██████▉   | 51/74 [00:13<00:05,  3.96it/s] 70%|███████   | 52/74 [00:14<00:05,  3.72it/s] 72%|███████▏  | 53/74 [00:14<00:07,  3.00it/s] 73%|███████▎  | 54/74 [00:14<00:06,  3.26it/s] 74%|███████▍  | 55/74 [00:15<00:06,  3.08it/s] 76%|███████▌  | 56/74 [00:15<00:06,  2.97it/s] 77%|███████▋  | 57/74 [00:15<00:05,  3.21it/s] 78%|███████▊  | 58/74 [00:16<00:04,  3.25it/s] 80%|███████▉  | 59/74 [00:16<00:04,  3.40it/s] 81%|████████  | 60/74 [00:16<00:03,  3.86it/s] 82%|████████▏ | 61/74 [00:17<00:03,  3.68it/s] 84%|████████▍ | 62/74 [00:17<00:03,  3.17it/s] 85%|████████▌ | 63/74 [00:17<00:03,  2.90it/s] 86%|████████▋ | 64/74 [00:18<00:03,  2.67it/s] 88%|████████▊ | 65/74 [00:18<00:03,  2.87it/s] 89%|████████▉ | 66/74 [00:18<00:02,  3.02it/s] 91%|█████████ | 67/74 [00:19<00:02,  2.80it/s] 92%|█████████▏| 68/74 [00:19<00:01,  3.03it/s] 93%|█████████▎| 69/74 [00:19<00:01,  3.40it/s] 95%|█████████▍| 70/74 [00:20<00:01,  3.11it/s] 96%|█████████▌| 71/74 [00:20<00:00,  3.18it/s] 97%|█████████▋| 72/74 [00:20<00:00,  3.00it/s] 99%|█████████▊| 73/74 [00:21<00:00,  3.00it/s]100%|██████████| 74/74 [00:21<00:00,  3.58it/s]100%|██████████| 74/74 [00:21<00:00,  3.47it/s]
Stage 2 

Stage 1 history model:
	Train acc 75.1766 Val acc 58.0280 Test acc 56.1411
Stage: 2, threshold 0.75, confident nodes: 60213 / 106818
		 val confident nodes: 36792 / 64879,  val confident level: 0.7458958625793457
		test confident nodes: 23421 / 41939, test confident_level: 0.7210623025894165
Current num label hops = 2
# Params: 11720737
Epoch:20, avg epoch time:22.2510
 Train loss:1.7842121901719465, Val loss:1.7290855646133423, Test loss:1.8264150619506836
 Train acc:55.9160, Val acc:57.4562, Test acc:55.7429
Best Epoch 19,Val 57.4562, Test 55.7429

Epoch:40, avg epoch time:22.4355
 Train loss:1.5680603238119595, Val loss:1.7756476402282715, Test loss:1.8890658617019653
 Train acc:58.2670, Val acc:57.7398, Test acc:56.0028
Best Epoch 30,Val 58.0018, Test 56.4677

Epoch:60, avg epoch time:22.4110
 Train loss:1.4570415434630022, Val loss:1.8156914710998535, Test loss:1.9520972967147827
 Train acc:59.6865, Val acc:58.1421, Test acc:56.3604
Best Epoch 57,Val 58.2207, Test 56.3509

Epoch:80, avg epoch time:22.4775
 Train loss:1.3875284246776416, Val loss:1.8750503063201904, Test loss:2.0296573638916016
 Train acc:60.6172, Val acc:58.0434, Test acc:56.2603
Best Epoch 75,Val 58.3101, Test 56.4367

Epoch:100, avg epoch time:22.4776
 Train loss:1.3343569472216177, Val loss:1.87771737575531, Test loss:2.032987594604492
 Train acc:61.4239, Val acc:58.3486, Test acc:56.4320
Best Epoch 93,Val 58.4935, Test 56.5488

Epoch:120, avg epoch time:22.7230
 Train loss:1.2936915418376094, Val loss:1.951139211654663, Test loss:2.121904134750366
 Train acc:62.0778, Val acc:58.1143, Test acc:56.3414
Best Epoch 93,Val 58.4935, Test 56.5488

Epoch:140, avg epoch time:22.6232
 Train loss:1.2629241217737612, Val loss:1.9558569192886353, Test loss:2.141866683959961
 Train acc:62.6809, Val acc:58.2870, Test acc:56.3962
Best Epoch 93,Val 58.4935, Test 56.5488

Epoch:160, avg epoch time:22.6482
 Train loss:1.230974997299305, Val loss:1.959110975265503, Test loss:2.1339621543884277
 Train acc:63.2275, Val acc:58.3671, Test acc:56.6632
Best Epoch 93,Val 58.4935, Test 56.5488

Epoch:180, avg epoch time:22.6674
 Train loss:1.2080343616181526, Val loss:1.9839617013931274, Test loss:2.176008701324463
 Train acc:63.6400, Val acc:58.4010, Test acc:56.4820
Best Epoch 172,Val 58.5012, Test 56.7109

Epoch:200, avg epoch time:22.7313
 Train loss:1.1877258152201555, Val loss:2.0218472480773926, Test loss:2.2050113677978516
 Train acc:64.0339, Val acc:58.3517, Test acc:56.6537
Best Epoch 181,Val 58.6291, Test 56.7205

Epoch:220, avg epoch time:22.6923
 Train loss:1.1697328591692275, Val loss:2.069455623626709, Test loss:2.2603657245635986
 Train acc:64.4058, Val acc:58.2269, Test acc:56.6942
Best Epoch 181,Val 58.6291, Test 56.7205

Epoch:240, avg epoch time:22.7506
 Train loss:1.1531035571858503, Val loss:2.0948798656463623, Test loss:2.291353702545166
 Train acc:64.7149, Val acc:58.1667, Test acc:56.4010
Best Epoch 181,Val 58.6291, Test 56.7205

Epoch:260, avg epoch time:22.7702
 Train loss:1.1381917967312578, Val loss:2.0689144134521484, Test loss:2.256373882293701
 Train acc:65.0756, Val acc:58.2453, Test acc:56.6561
Best Epoch 181,Val 58.6291, Test 56.7205

Epoch:280, avg epoch time:22.7533
 Train loss:1.1235509920811309, Val loss:2.074953079223633, Test loss:2.2739174365997314
 Train acc:65.3381, Val acc:58.3902, Test acc:56.6418
Best Epoch 181,Val 58.6291, Test 56.7205

Best Epoch 181, Val 58.6291, Test 56.7205
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:17,  4.29it/s]  3%|▎         | 2/74 [00:00<00:15,  4.51it/s]  4%|▍         | 3/74 [00:00<00:16,  4.20it/s]  5%|▌         | 4/74 [00:00<00:17,  4.04it/s]  7%|▋         | 5/74 [00:01<00:16,  4.21it/s]  8%|▊         | 6/74 [00:01<00:17,  3.90it/s]  9%|▉         | 7/74 [00:01<00:16,  4.07it/s] 11%|█         | 8/74 [00:02<00:21,  3.10it/s] 12%|█▏        | 9/74 [00:02<00:18,  3.52it/s] 14%|█▎        | 10/74 [00:02<00:16,  3.97it/s] 15%|█▍        | 11/74 [00:02<00:15,  4.08it/s] 16%|█▌        | 12/74 [00:03<00:15,  4.11it/s] 18%|█▊        | 13/74 [00:03<00:14,  4.27it/s] 19%|█▉        | 14/74 [00:03<00:14,  4.14it/s] 20%|██        | 15/74 [00:03<00:15,  3.81it/s] 22%|██▏       | 16/74 [00:04<00:15,  3.66it/s] 23%|██▎       | 17/74 [00:04<00:19,  2.86it/s] 24%|██▍       | 18/74 [00:04<00:16,  3.44it/s] 26%|██▌       | 19/74 [00:04<00:14,  3.89it/s] 27%|██▋       | 20/74 [00:05<00:15,  3.45it/s] 28%|██▊       | 21/74 [00:05<00:12,  4.11it/s] 30%|██▉       | 22/74 [00:05<00:13,  3.94it/s] 31%|███       | 23/74 [00:06<00:13,  3.83it/s] 32%|███▏      | 24/74 [00:06<00:12,  3.96it/s] 34%|███▍      | 25/74 [00:06<00:12,  3.81it/s] 35%|███▌      | 26/74 [00:06<00:11,  4.17it/s] 36%|███▋      | 27/74 [00:07<00:13,  3.56it/s] 38%|███▊      | 28/74 [00:07<00:11,  3.88it/s] 39%|███▉      | 29/74 [00:07<00:10,  4.13it/s] 41%|████      | 30/74 [00:07<00:10,  4.21it/s] 42%|████▏     | 31/74 [00:07<00:10,  4.22it/s] 43%|████▎     | 32/74 [00:08<00:11,  3.63it/s] 45%|████▍     | 33/74 [00:08<00:10,  3.89it/s] 46%|████▌     | 34/74 [00:08<00:10,  3.97it/s] 47%|████▋     | 35/74 [00:09<00:09,  4.12it/s] 49%|████▊     | 36/74 [00:09<00:11,  3.38it/s] 50%|█████     | 37/74 [00:09<00:09,  3.73it/s] 51%|█████▏    | 38/74 [00:09<00:08,  4.02it/s] 53%|█████▎    | 39/74 [00:10<00:09,  3.88it/s] 54%|█████▍    | 40/74 [00:10<00:08,  3.78it/s] 55%|█████▌    | 41/74 [00:10<00:09,  3.58it/s] 57%|█████▋    | 42/74 [00:10<00:07,  4.01it/s] 58%|█████▊    | 43/74 [00:11<00:07,  4.20it/s] 59%|█████▉    | 44/74 [00:11<00:06,  4.41it/s] 61%|██████    | 45/74 [00:11<00:06,  4.50it/s] 62%|██████▏   | 46/74 [00:11<00:07,  3.66it/s] 64%|██████▎   | 47/74 [00:12<00:07,  3.52it/s] 65%|██████▍   | 48/74 [00:12<00:06,  3.78it/s] 66%|██████▌   | 49/74 [00:12<00:06,  4.15it/s] 68%|██████▊   | 50/74 [00:12<00:05,  4.23it/s] 69%|██████▉   | 51/74 [00:13<00:05,  4.16it/s] 70%|███████   | 52/74 [00:13<00:04,  4.67it/s] 72%|███████▏  | 53/74 [00:13<00:05,  4.14it/s] 73%|███████▎  | 54/74 [00:13<00:04,  4.43it/s] 74%|███████▍  | 55/74 [00:14<00:04,  4.04it/s] 76%|███████▌  | 56/74 [00:14<00:04,  4.15it/s] 77%|███████▋  | 57/74 [00:14<00:03,  4.27it/s] 78%|███████▊  | 58/74 [00:14<00:03,  4.52it/s] 80%|███████▉  | 59/74 [00:14<00:03,  4.99it/s] 81%|████████  | 60/74 [00:15<00:02,  5.35it/s] 82%|████████▏ | 61/74 [00:15<00:02,  5.18it/s] 84%|████████▍ | 62/74 [00:15<00:02,  5.32it/s] 85%|████████▌ | 63/74 [00:15<00:02,  5.13it/s] 86%|████████▋ | 64/74 [00:15<00:02,  4.88it/s] 88%|████████▊ | 65/74 [00:16<00:02,  3.71it/s] 89%|████████▉ | 66/74 [00:16<00:02,  3.95it/s] 91%|█████████ | 67/74 [00:16<00:01,  4.12it/s] 92%|█████████▏| 68/74 [00:16<00:01,  3.97it/s] 93%|█████████▎| 69/74 [00:17<00:01,  4.46it/s] 95%|█████████▍| 70/74 [00:17<00:00,  4.46it/s] 96%|█████████▌| 71/74 [00:17<00:00,  4.79it/s] 97%|█████████▋| 72/74 [00:17<00:00,  4.27it/s] 99%|█████████▊| 73/74 [00:17<00:00,  4.63it/s]100%|██████████| 74/74 [00:18<00:00,  3.85it/s]100%|██████████| 74/74 [00:18<00:00,  4.03it/s]
Stage 3 

Stage 2 history model:
	Train acc 69.7604 Val acc 58.6291 Test acc 56.7205
Stage: 3, threshold 0.75, confident nodes: 72857 / 106818
		 val confident nodes: 44106 / 64879,  val confident level: 0.7081122994422913
		test confident nodes: 28751 / 41939, test confident_level: 0.6766025424003601
Current num label hops = 2
# Params: 11720737
Epoch:20, avg epoch time:22.8333
 Train loss:1.866422542383973, Val loss:1.8047425746917725, Test loss:1.9309033155441284
 Train acc:55.6384, Val acc:57.7259, Test acc:55.9169
Best Epoch 18,Val 57.7752, Test 55.8812

Epoch:40, avg epoch time:23.0066
 Train loss:1.633446433174778, Val loss:1.8645527362823486, Test loss:2.0350029468536377
 Train acc:57.9047, Val acc:58.1097, Test acc:56.2007
Best Epoch 35,Val 58.2453, Test 56.3962

Epoch:60, avg epoch time:22.8111
 Train loss:1.5135217653193944, Val loss:1.9475677013397217, Test loss:2.1347873210906982
 Train acc:59.1323, Val acc:58.2361, Test acc:56.4749
Best Epoch 58,Val 58.4442, Test 56.5560

Epoch:80, avg epoch time:22.4750
 Train loss:1.4385598629293308, Val loss:2.0336573123931885, Test loss:2.244037628173828
 Train acc:60.0965, Val acc:58.3425, Test acc:56.5869
Best Epoch 58,Val 58.4442, Test 56.5560

Epoch:100, avg epoch time:22.1391
 Train loss:1.3826337767318941, Val loss:2.0826892852783203, Test loss:2.3158154487609863
 Train acc:60.7842, Val acc:58.4858, Test acc:56.6275
Best Epoch 97,Val 58.5459, Test 56.5393

Epoch:120, avg epoch time:21.7353
 Train loss:1.3417580816107737, Val loss:2.1283299922943115, Test loss:2.3668506145477295
 Train acc:61.4220, Val acc:58.5829, Test acc:56.5679
Best Epoch 103,Val 58.6446, Test 56.6704

Epoch:140, avg epoch time:21.4517
 Train loss:1.3043707542016472, Val loss:2.150094747543335, Test loss:2.3990368843078613
 Train acc:61.9976, Val acc:58.4781, Test acc:56.6132
Best Epoch 128,Val 58.6893, Test 56.6632

Epoch:160, avg epoch time:21.2820
 Train loss:1.2767415768663648, Val loss:2.2116243839263916, Test loss:2.473412275314331
 Train acc:62.4312, Val acc:58.5875, Test acc:56.6966
Best Epoch 145,Val 58.7155, Test 56.6156

Epoch:180, avg epoch time:21.1068
 Train loss:1.2516254589591227, Val loss:2.241669178009033, Test loss:2.505736827850342
 Train acc:62.8892, Val acc:58.6785, Test acc:56.7109
Best Epoch 145,Val 58.7155, Test 56.6156

Epoch:200, avg epoch time:21.0301
 Train loss:1.233267198146229, Val loss:2.2427761554718018, Test loss:2.5079288482666016
 Train acc:63.2307, Val acc:58.7232, Test acc:56.8516
Best Epoch 191,Val 58.7432, Test 56.7872

Epoch:220, avg epoch time:20.8837
 Train loss:1.2127782559730638, Val loss:2.2909457683563232, Test loss:2.558685541152954
 Train acc:63.5841, Val acc:58.5105, Test acc:56.6752
Best Epoch 205,Val 58.7894, Test 56.8063

Epoch:240, avg epoch time:20.7733
 Train loss:1.19645442761166, Val loss:2.329634189605713, Test loss:2.606787919998169
 Train acc:63.9132, Val acc:58.6045, Test acc:56.5965
Best Epoch 238,Val 58.8388, Test 56.8612

Epoch:260, avg epoch time:20.7436
 Train loss:1.1807403933834022, Val loss:2.276959180831909, Test loss:2.5542054176330566
 Train acc:64.2625, Val acc:58.7262, Test acc:56.7968
Best Epoch 238,Val 58.8388, Test 56.8612

Epoch:280, avg epoch time:20.7137
 Train loss:1.1672051255132112, Val loss:2.3469483852386475, Test loss:2.6322805881500244
 Train acc:64.4307, Val acc:58.7679, Test acc:56.8397
Best Epoch 238,Val 58.8388, Test 56.8612

Epoch:300, avg epoch time:20.6950
 Train loss:1.154809191193379, Val loss:2.3499755859375, Test loss:2.632957935333252
 Train acc:64.6683, Val acc:58.7617, Test acc:56.8230
Best Epoch 238,Val 58.8388, Test 56.8612

Epoch:320, avg epoch time:20.6340
 Train loss:1.1423390482512998, Val loss:2.3948559761047363, Test loss:2.6837151050567627
 Train acc:64.9655, Val acc:58.7062, Test acc:56.7205
Best Epoch 238,Val 58.8388, Test 56.8612

Epoch:340, avg epoch time:20.6145
 Train loss:1.1306596641809168, Val loss:2.3975815773010254, Test loss:2.6926982402801514
 Train acc:65.2088, Val acc:58.6723, Test acc:56.7777
Best Epoch 324,Val 58.8511, Test 56.8302

Epoch:360, avg epoch time:20.6298
 Train loss:1.1234232489491853, Val loss:2.413965940475464, Test loss:2.7112624645233154
 Train acc:65.3289, Val acc:58.7679, Test acc:56.7562
Best Epoch 347,Val 58.8588, Test 56.8206

Epoch:380, avg epoch time:20.5826
 Train loss:1.114623507983248, Val loss:2.451284646987915, Test loss:2.7583751678466797
 Train acc:65.5346, Val acc:58.6815, Test acc:56.7443
Best Epoch 372,Val 58.8881, Test 56.9160

Epoch:400, avg epoch time:20.5724
 Train loss:1.1035301148051946, Val loss:2.4219160079956055, Test loss:2.7190372943878174
 Train acc:65.7484, Val acc:58.7540, Test acc:56.8254
Best Epoch 372,Val 58.8881, Test 56.9160

Best Epoch 372, Val 58.8881, Test 56.9160
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:20,  3.49it/s]  3%|▎         | 2/74 [00:00<00:24,  2.95it/s]  4%|▍         | 3/74 [00:00<00:17,  4.07it/s]  5%|▌         | 4/74 [00:00<00:15,  4.62it/s]  7%|▋         | 5/74 [00:01<00:14,  4.78it/s]  8%|▊         | 6/74 [00:01<00:14,  4.82it/s]  9%|▉         | 7/74 [00:01<00:12,  5.40it/s] 11%|█         | 8/74 [00:01<00:11,  5.72it/s] 12%|█▏        | 9/74 [00:01<00:10,  6.09it/s] 14%|█▎        | 10/74 [00:02<00:11,  5.56it/s] 15%|█▍        | 11/74 [00:02<00:16,  3.81it/s] 16%|█▌        | 12/74 [00:02<00:15,  3.88it/s] 18%|█▊        | 13/74 [00:02<00:14,  4.19it/s] 19%|█▉        | 14/74 [00:03<00:13,  4.32it/s] 20%|██        | 15/74 [00:03<00:15,  3.88it/s] 22%|██▏       | 16/74 [00:03<00:16,  3.56it/s] 23%|██▎       | 17/74 [00:04<00:16,  3.40it/s] 24%|██▍       | 18/74 [00:04<00:15,  3.63it/s] 26%|██▌       | 19/74 [00:04<00:13,  3.96it/s] 27%|██▋       | 20/74 [00:04<00:14,  3.81it/s] 28%|██▊       | 21/74 [00:05<00:15,  3.35it/s] 30%|██▉       | 22/74 [00:05<00:14,  3.61it/s] 31%|███       | 23/74 [00:05<00:12,  4.03it/s] 32%|███▏      | 24/74 [00:05<00:12,  3.89it/s] 34%|███▍      | 25/74 [00:06<00:11,  4.19it/s] 35%|███▌      | 26/74 [00:06<00:11,  4.11it/s] 36%|███▋      | 27/74 [00:06<00:09,  4.74it/s] 38%|███▊      | 28/74 [00:06<00:09,  4.76it/s] 39%|███▉      | 29/74 [00:06<00:08,  5.32it/s] 41%|████      | 30/74 [00:07<00:09,  4.82it/s] 42%|████▏     | 31/74 [00:07<00:08,  5.20it/s] 43%|████▎     | 32/74 [00:07<00:07,  5.62it/s] 45%|████▍     | 33/74 [00:07<00:06,  6.09it/s] 46%|████▌     | 34/74 [00:07<00:07,  5.57it/s] 47%|████▋     | 35/74 [00:07<00:06,  5.95it/s] 49%|████▊     | 36/74 [00:08<00:06,  6.15it/s] 50%|█████     | 37/74 [00:08<00:06,  5.43it/s] 51%|█████▏    | 38/74 [00:08<00:06,  5.70it/s] 53%|█████▎    | 39/74 [00:08<00:08,  4.14it/s] 54%|█████▍    | 40/74 [00:09<00:11,  3.01it/s] 55%|█████▌    | 41/74 [00:09<00:09,  3.39it/s] 57%|█████▋    | 42/74 [00:09<00:10,  3.05it/s] 58%|█████▊    | 43/74 [00:10<00:10,  3.08it/s] 59%|█████▉    | 44/74 [00:10<00:09,  3.05it/s] 61%|██████    | 45/74 [00:10<00:09,  2.98it/s] 62%|██████▏   | 46/74 [00:11<00:08,  3.33it/s] 64%|██████▎   | 47/74 [00:11<00:07,  3.54it/s] 65%|██████▍   | 48/74 [00:11<00:06,  3.96it/s] 66%|██████▌   | 49/74 [00:11<00:06,  3.81it/s] 68%|██████▊   | 50/74 [00:12<00:06,  3.87it/s] 69%|██████▉   | 51/74 [00:12<00:05,  4.04it/s] 70%|███████   | 52/74 [00:12<00:05,  4.17it/s] 72%|███████▏  | 53/74 [00:12<00:04,  4.32it/s] 73%|███████▎  | 54/74 [00:13<00:04,  4.03it/s] 74%|███████▍  | 55/74 [00:13<00:04,  4.06it/s] 76%|███████▌  | 56/74 [00:13<00:04,  3.90it/s] 77%|███████▋  | 57/74 [00:13<00:04,  3.98it/s] 78%|███████▊  | 58/74 [00:14<00:03,  4.09it/s] 80%|███████▉  | 59/74 [00:14<00:05,  2.83it/s] 81%|████████  | 60/74 [00:14<00:04,  3.12it/s] 82%|████████▏ | 61/74 [00:15<00:04,  3.11it/s] 84%|████████▍ | 62/74 [00:15<00:03,  3.72it/s] 85%|████████▌ | 63/74 [00:15<00:02,  4.03it/s] 86%|████████▋ | 64/74 [00:15<00:02,  3.82it/s] 88%|████████▊ | 65/74 [00:16<00:02,  3.94it/s] 89%|████████▉ | 66/74 [00:16<00:01,  4.58it/s] 91%|█████████ | 67/74 [00:16<00:01,  4.94it/s] 92%|█████████▏| 68/74 [00:16<00:01,  4.93it/s] 93%|█████████▎| 69/74 [00:16<00:00,  5.54it/s] 95%|█████████▍| 70/74 [00:16<00:00,  4.95it/s] 96%|█████████▌| 71/74 [00:17<00:00,  4.06it/s] 97%|█████████▋| 72/74 [00:17<00:00,  4.25it/s] 99%|█████████▊| 73/74 [00:17<00:00,  4.20it/s]100%|██████████| 74/74 [00:17<00:00,  4.14it/s]
