Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.2.5, while the latest version is 1.3.3.
Namespace(seed=1, dataset='ogbn-mag', gpu=0, root='../data/', emb_path='../data/', stages=[400, 400, 400, 400], extra_embedding='complex', embed_size=256, num_hops=2, label_feats=True, num_label_hops=2, hidden=512, dropout=0.5, n_layers_1=2, n_layers_2=2, n_layers_3=4, input_drop=0.1, att_drop=0.0, label_drop=0.0, residual=True, act='leaky_relu', bns=True, label_bns=True, amp=True, lr=0.001, weight_decay=0.0, eval_every=1, batch_size=10000, patience=100, threshold=0.75, gama=10.0, start_stage=0, reload='', moving_k=1, store_model=False, moe_widget=['feat_ngnn', 'label_ngnn'], num_expert=2, top_k=1, expert_drop=0.0, gate='naive')
Use extra embeddings generated with the complex method
Current num hops = 2
./output/ogbn-mag/18a86a3c65204a13892d7247fda432c2 

Stage 0 

Current num label hops = 2
# Params: 8897569
Epoch:20, avg epoch time:18.1563
 Train loss:1.5750598131664215, Val loss:1.649421215057373, Test loss:1.6925177574157715
 Train acc:56.1679, Val acc:52.8461, Test acc:51.2435
Best Epoch 17,Val 52.9077, Test 51.4819

Epoch:40, avg epoch time:18.6948
 Train loss:1.451127398581732, Val loss:1.5891743898391724, Test loss:1.626084327697754
 Train acc:58.4245, Val acc:53.8079, Test acc:52.3379
Best Epoch 36,Val 54.4660, Test 52.9388

Epoch:60, avg epoch time:18.7713
 Train loss:1.3889200819863214, Val loss:1.542623519897461, Test loss:1.5871831178665161
 Train acc:59.6282, Val acc:55.0055, Test acc:53.0747
Best Epoch 59,Val 55.0055, Test 53.0747

Epoch:80, avg epoch time:18.8609
 Train loss:1.3482104180351135, Val loss:1.5485824346542358, Test loss:1.5924180746078491
 Train acc:60.4502, Val acc:54.7419, Test acc:52.9555
Best Epoch 76,Val 55.1611, Test 53.2869

Epoch:100, avg epoch time:18.9921
 Train loss:1.3140853984015328, Val loss:1.5354843139648438, Test loss:1.5801875591278076
 Train acc:61.1399, Val acc:55.1427, Test acc:53.6136
Best Epoch 86,Val 55.4139, Test 53.7566

Epoch:120, avg epoch time:18.9916
 Train loss:1.2874375203299144, Val loss:1.5360265970230103, Test loss:1.5829182863235474
 Train acc:61.7436, Val acc:55.1658, Test acc:53.3155
Best Epoch 118,Val 55.4586, Test 53.5373

Epoch:140, avg epoch time:19.0263
 Train loss:1.2665601363257757, Val loss:1.5403474569320679, Test loss:1.5842710733413696
 Train acc:62.1952, Val acc:55.1257, Test acc:53.1772
Best Epoch 118,Val 55.4586, Test 53.5373

Epoch:160, avg epoch time:18.9547
 Train loss:1.2505480543015495, Val loss:1.5370312929153442, Test loss:1.5866891145706177
 Train acc:62.5250, Val acc:55.1904, Test acc:53.3227
Best Epoch 149,Val 55.4787, Test 53.6541

Epoch:180, avg epoch time:18.9407
 Train loss:1.2358804316747756, Val loss:1.5325766801834106, Test loss:1.5802128314971924
 Train acc:62.8233, Val acc:55.2629, Test acc:53.5587
Best Epoch 149,Val 55.4787, Test 53.6541

Epoch:200, avg epoch time:18.9142
 Train loss:1.221351738960024, Val loss:1.5427621603012085, Test loss:1.5931689739227295
 Train acc:63.1900, Val acc:55.1103, Test acc:53.3155
Best Epoch 190,Val 55.5157, Test 53.7328

Epoch:220, avg epoch time:18.9425
 Train loss:1.2101964269365584, Val loss:1.535773754119873, Test loss:1.5824528932571411
 Train acc:63.4272, Val acc:55.2259, Test acc:53.5897
Best Epoch 216,Val 55.5758, Test 53.7543

Epoch:240, avg epoch time:18.9056
 Train loss:1.1982983767040192, Val loss:1.530815839767456, Test loss:1.5790797472000122
 Train acc:63.7353, Val acc:55.3322, Test acc:53.7423
Best Epoch 216,Val 55.5758, Test 53.7543

Epoch:260, avg epoch time:18.8880
 Train loss:1.1889830789868794, Val loss:1.531476378440857, Test loss:1.5818363428115845
 Train acc:63.9440, Val acc:55.5573, Test acc:53.8997
Best Epoch 254,Val 55.6220, Test 53.8329

Epoch:280, avg epoch time:18.8728
 Train loss:1.1797131356738864, Val loss:1.5361580848693848, Test loss:1.5852558612823486
 Train acc:64.1553, Val acc:55.4124, Test acc:53.6899
Best Epoch 254,Val 55.6220, Test 53.8329

Epoch:300, avg epoch time:18.9011
 Train loss:1.1731085436684745, Val loss:1.5329339504241943, Test loss:1.580820918083191
 Train acc:64.3049, Val acc:55.4124, Test acc:53.8902
Best Epoch 294,Val 55.7361, Test 53.9832

Epoch:320, avg epoch time:18.9228
 Train loss:1.1649438407686021, Val loss:1.5340667963027954, Test loss:1.5826131105422974
 Train acc:64.5147, Val acc:55.2767, Test acc:53.8592
Best Epoch 294,Val 55.7361, Test 53.9832

Epoch:340, avg epoch time:18.9080
 Train loss:1.1569146428789412, Val loss:1.5369853973388672, Test loss:1.5881091356277466
 Train acc:64.6702, Val acc:55.3800, Test acc:53.6684
Best Epoch 294,Val 55.7361, Test 53.9832

Epoch:360, avg epoch time:18.9268
 Train loss:1.1501086931380013, Val loss:1.5402377843856812, Test loss:1.5874499082565308
 Train acc:64.8038, Val acc:55.5943, Test acc:53.8115
Best Epoch 294,Val 55.7361, Test 53.9832

Epoch:380, avg epoch time:18.9190
 Train loss:1.145627914913117, Val loss:1.546432375907898, Test loss:1.596489667892456
 Train acc:64.9474, Val acc:55.2783, Test acc:53.4586
Best Epoch 294,Val 55.7361, Test 53.9832

Best Epoch 294, Val 55.7361, Test 53.9832
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:21,  3.46it/s]  3%|▎         | 2/74 [00:00<00:18,  3.89it/s]  4%|▍         | 3/74 [00:00<00:19,  3.56it/s]  5%|▌         | 4/74 [00:01<00:19,  3.56it/s]  7%|▋         | 5/74 [00:01<00:20,  3.34it/s]  8%|▊         | 6/74 [00:01<00:18,  3.59it/s]  9%|▉         | 7/74 [00:01<00:17,  3.90it/s] 11%|█         | 8/74 [00:02<00:16,  3.96it/s] 12%|█▏        | 9/74 [00:02<00:17,  3.66it/s] 14%|█▎        | 10/74 [00:02<00:17,  3.75it/s] 15%|█▍        | 11/74 [00:03<00:19,  3.31it/s] 16%|█▌        | 12/74 [00:03<00:17,  3.46it/s] 18%|█▊        | 13/74 [00:03<00:18,  3.34it/s] 19%|█▉        | 14/74 [00:04<00:19,  3.06it/s] 20%|██        | 15/74 [00:04<00:18,  3.22it/s] 22%|██▏       | 16/74 [00:04<00:16,  3.59it/s] 23%|██▎       | 17/74 [00:04<00:14,  3.96it/s] 24%|██▍       | 18/74 [00:04<00:13,  4.08it/s] 26%|██▌       | 19/74 [00:05<00:15,  3.67it/s] 27%|██▋       | 20/74 [00:05<00:14,  3.61it/s] 28%|██▊       | 21/74 [00:05<00:12,  4.12it/s] 30%|██▉       | 22/74 [00:05<00:11,  4.54it/s] 31%|███       | 23/74 [00:06<00:12,  3.95it/s] 32%|███▏      | 24/74 [00:06<00:11,  4.48it/s] 34%|███▍      | 25/74 [00:06<00:11,  4.16it/s] 35%|███▌      | 26/74 [00:07<00:13,  3.54it/s] 36%|███▋      | 27/74 [00:07<00:12,  3.79it/s] 38%|███▊      | 28/74 [00:07<00:12,  3.81it/s] 39%|███▉      | 29/74 [00:07<00:10,  4.16it/s] 41%|████      | 30/74 [00:08<00:11,  3.94it/s] 42%|████▏     | 31/74 [00:08<00:11,  3.88it/s] 43%|████▎     | 32/74 [00:08<00:09,  4.22it/s] 45%|████▍     | 33/74 [00:08<00:11,  3.50it/s] 46%|████▌     | 34/74 [00:09<00:11,  3.52it/s] 47%|████▋     | 35/74 [00:09<00:10,  3.87it/s] 49%|████▊     | 36/74 [00:09<00:09,  3.83it/s] 50%|█████     | 37/74 [00:09<00:09,  3.90it/s] 51%|█████▏    | 38/74 [00:10<00:09,  3.83it/s] 53%|█████▎    | 39/74 [00:10<00:08,  3.95it/s] 54%|█████▍    | 40/74 [00:10<00:08,  4.03it/s] 55%|█████▌    | 41/74 [00:10<00:08,  3.94it/s] 57%|█████▋    | 42/74 [00:11<00:10,  2.99it/s] 58%|█████▊    | 43/74 [00:11<00:09,  3.31it/s] 59%|█████▉    | 44/74 [00:11<00:08,  3.50it/s] 61%|██████    | 45/74 [00:12<00:07,  4.03it/s] 62%|██████▏   | 46/74 [00:12<00:07,  3.71it/s] 64%|██████▎   | 47/74 [00:12<00:07,  3.84it/s] 65%|██████▍   | 48/74 [00:12<00:06,  3.97it/s] 66%|██████▌   | 49/74 [00:13<00:06,  4.02it/s] 68%|██████▊   | 50/74 [00:13<00:05,  4.18it/s] 69%|██████▉   | 51/74 [00:13<00:05,  4.05it/s] 70%|███████   | 52/74 [00:13<00:05,  3.78it/s] 72%|███████▏  | 53/74 [00:13<00:04,  4.50it/s] 73%|███████▎  | 54/74 [00:14<00:03,  5.17it/s] 74%|███████▍  | 55/74 [00:14<00:03,  5.29it/s] 76%|███████▌  | 56/74 [00:14<00:03,  4.80it/s] 77%|███████▋  | 57/74 [00:14<00:04,  4.22it/s] 78%|███████▊  | 58/74 [00:15<00:03,  4.18it/s] 80%|███████▉  | 59/74 [00:15<00:03,  4.24it/s] 81%|████████  | 60/74 [00:15<00:03,  3.95it/s] 82%|████████▏ | 61/74 [00:16<00:04,  3.09it/s] 84%|████████▍ | 62/74 [00:16<00:03,  3.13it/s] 85%|████████▌ | 63/74 [00:16<00:03,  2.82it/s] 86%|████████▋ | 64/74 [00:17<00:03,  2.76it/s] 88%|████████▊ | 65/74 [00:17<00:03,  2.95it/s] 89%|████████▉ | 66/74 [00:17<00:02,  3.00it/s] 91%|█████████ | 67/74 [00:18<00:02,  3.00it/s] 92%|█████████▏| 68/74 [00:18<00:01,  3.25it/s] 93%|█████████▎| 69/74 [00:18<00:01,  3.70it/s] 95%|█████████▍| 70/74 [00:18<00:00,  4.54it/s] 96%|█████████▌| 71/74 [00:18<00:00,  4.78it/s] 97%|█████████▋| 72/74 [00:19<00:00,  5.12it/s] 99%|█████████▊| 73/74 [00:19<00:00,  4.59it/s]100%|██████████| 74/74 [00:19<00:00,  5.14it/s]100%|██████████| 74/74 [00:19<00:00,  3.80it/s]
Stage 1 

Stage 0 history model:
	Train acc 73.3299 Val acc 55.7361 Test acc 53.9832
Stage: 1, threshold 0.75, confident nodes: 34997 / 106818
		 val confident nodes: 22177 / 64879,  val confident level: 0.8098931312561035
		test confident nodes: 12820 / 41939, test confident_level: 0.8015600442886353
Current num label hops = 2
# Params: 12248101
Epoch:20, avg epoch time:27.3173
 Train loss:1.5490470128272897, Val loss:1.583030343055725, Test loss:1.6488665342330933
 Train acc:57.8065, Val acc:56.9553, Test acc:55.0895
Best Epoch 19,Val 56.9553, Test 55.0895

Epoch:40, avg epoch time:27.2049
 Train loss:1.3966235883200346, Val loss:1.5884345769882202, Test loss:1.6681370735168457
 Train acc:60.1891, Val acc:57.1988, Test acc:55.3924
Best Epoch 33,Val 57.4793, Test 55.5068

Epoch:60, avg epoch time:27.5030
 Train loss:1.3137870742313897, Val loss:1.608496904373169, Test loss:1.6963448524475098
 Train acc:61.5165, Val acc:57.3652, Test acc:55.5450
Best Epoch 51,Val 57.7660, Test 55.7977

Epoch:80, avg epoch time:27.5271
 Train loss:1.2598569446535253, Val loss:1.6591570377349854, Test loss:1.7498053312301636
 Train acc:62.6223, Val acc:57.2728, Test acc:55.4257
Best Epoch 51,Val 57.7660, Test 55.7977

Epoch:100, avg epoch time:27.4744
 Train loss:1.2194836032924368, Val loss:1.6480014324188232, Test loss:1.7389789819717407
 Train acc:63.3751, Val acc:57.6489, Test acc:55.4925
Best Epoch 96,Val 57.8523, Test 55.8072

Epoch:120, avg epoch time:27.5042
 Train loss:1.1852935677144065, Val loss:1.6580300331115723, Test loss:1.7504563331604004
 Train acc:64.1380, Val acc:57.6612, Test acc:55.7357
Best Epoch 96,Val 57.8523, Test 55.8072

Epoch:140, avg epoch time:27.4703
 Train loss:1.1587688478071299, Val loss:1.6674816608428955, Test loss:1.7590395212173462
 Train acc:64.7744, Val acc:57.7583, Test acc:55.9527
Best Epoch 134,Val 57.8939, Test 55.8359

Epoch:160, avg epoch time:27.4254
 Train loss:1.1353455515050177, Val loss:1.6864416599273682, Test loss:1.7770177125930786
 Train acc:65.2519, Val acc:57.4639, Test acc:55.4639
Best Epoch 134,Val 57.8939, Test 55.8359

Epoch:180, avg epoch time:27.3905
 Train loss:1.1169193591644515, Val loss:1.6904655694961548, Test loss:1.784530758857727
 Train acc:65.6407, Val acc:57.5379, Test acc:55.5855
Best Epoch 134,Val 57.8939, Test 55.8359

Epoch:200, avg epoch time:27.4299
 Train loss:1.0986442085522323, Val loss:1.6917037963867188, Test loss:1.7843998670578003
 Train acc:65.9967, Val acc:57.7305, Test acc:55.8120
Best Epoch 185,Val 57.8985, Test 55.7834

Epoch:220, avg epoch time:27.4745
 Train loss:1.084254392937048, Val loss:1.7079812288284302, Test loss:1.804953932762146
 Train acc:66.3450, Val acc:57.8307, Test acc:55.8216
Best Epoch 185,Val 57.8985, Test 55.7834

Epoch:240, avg epoch time:27.4987
 Train loss:1.0702641846528693, Val loss:1.7135106325149536, Test loss:1.8068968057632446
 Train acc:66.7493, Val acc:57.5687, Test acc:55.6928
Best Epoch 229,Val 57.9309, Test 55.8072

Epoch:260, avg epoch time:27.4928
 Train loss:1.0578106268128353, Val loss:1.7286401987075806, Test loss:1.8184646368026733
 Train acc:67.0121, Val acc:57.5394, Test acc:55.5235
Best Epoch 229,Val 57.9309, Test 55.8072

Epoch:280, avg epoch time:27.4776
 Train loss:1.0478540765705393, Val loss:1.73542320728302, Test loss:1.8273882865905762
 Train acc:67.1410, Val acc:57.5487, Test acc:55.6093
Best Epoch 229,Val 57.9309, Test 55.8072

Epoch:300, avg epoch time:27.5006
 Train loss:1.0348661346222037, Val loss:1.7488408088684082, Test loss:1.8461558818817139
 Train acc:67.5784, Val acc:57.5841, Test acc:55.5807
Best Epoch 229,Val 57.9309, Test 55.8072

Epoch:320, avg epoch time:27.4931
 Train loss:1.0235010349928444, Val loss:1.7451711893081665, Test loss:1.8423389196395874
 Train acc:67.8224, Val acc:57.4639, Test acc:55.5450
Best Epoch 229,Val 57.9309, Test 55.8072

Best Epoch 229, Val 57.9309, Test 55.8072
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:25,  2.89it/s]  3%|▎         | 2/74 [00:00<00:23,  3.09it/s]  4%|▍         | 3/74 [00:00<00:21,  3.25it/s]  5%|▌         | 4/74 [00:01<00:19,  3.60it/s]  7%|▋         | 5/74 [00:01<00:24,  2.79it/s]  8%|▊         | 6/74 [00:02<00:25,  2.64it/s]  9%|▉         | 7/74 [00:02<00:22,  3.01it/s] 11%|█         | 8/74 [00:02<00:17,  3.86it/s] 12%|█▏        | 9/74 [00:02<00:16,  3.92it/s] 14%|█▎        | 10/74 [00:02<00:14,  4.27it/s] 15%|█▍        | 11/74 [00:03<00:15,  3.95it/s] 16%|█▌        | 12/74 [00:03<00:17,  3.46it/s] 18%|█▊        | 13/74 [00:03<00:18,  3.39it/s] 19%|█▉        | 14/74 [00:04<00:17,  3.35it/s] 20%|██        | 15/74 [00:04<00:20,  2.91it/s] 22%|██▏       | 16/74 [00:05<00:21,  2.70it/s] 23%|██▎       | 17/74 [00:05<00:22,  2.50it/s] 24%|██▍       | 18/74 [00:05<00:23,  2.40it/s] 26%|██▌       | 19/74 [00:06<00:22,  2.48it/s] 27%|██▋       | 20/74 [00:06<00:20,  2.59it/s] 28%|██▊       | 21/74 [00:07<00:21,  2.50it/s] 30%|██▉       | 22/74 [00:07<00:17,  2.90it/s] 31%|███       | 23/74 [00:07<00:16,  3.09it/s] 32%|███▏      | 24/74 [00:08<00:23,  2.14it/s] 34%|███▍      | 25/74 [00:08<00:20,  2.38it/s] 35%|███▌      | 26/74 [00:08<00:16,  2.83it/s] 36%|███▋      | 27/74 [00:09<00:13,  3.45it/s] 38%|███▊      | 28/74 [00:09<00:12,  3.67it/s] 39%|███▉      | 29/74 [00:09<00:11,  3.91it/s] 41%|████      | 30/74 [00:09<00:10,  4.32it/s] 42%|████▏     | 31/74 [00:09<00:09,  4.31it/s] 43%|████▎     | 32/74 [00:10<00:09,  4.24it/s] 45%|████▍     | 33/74 [00:10<00:09,  4.40it/s] 46%|████▌     | 34/74 [00:10<00:12,  3.10it/s] 47%|████▋     | 35/74 [00:11<00:12,  3.05it/s] 49%|████▊     | 36/74 [00:11<00:11,  3.30it/s] 50%|█████     | 37/74 [00:11<00:10,  3.54it/s] 51%|█████▏    | 38/74 [00:11<00:10,  3.60it/s] 53%|█████▎    | 39/74 [00:12<00:08,  4.16it/s] 54%|█████▍    | 40/74 [00:12<00:08,  3.81it/s] 55%|█████▌    | 41/74 [00:12<00:10,  3.20it/s] 57%|█████▋    | 42/74 [00:13<00:10,  3.11it/s] 58%|█████▊    | 43/74 [00:13<00:11,  2.78it/s] 59%|█████▉    | 44/74 [00:13<00:09,  3.23it/s] 61%|██████    | 45/74 [00:14<00:08,  3.49it/s] 62%|██████▏   | 46/74 [00:14<00:08,  3.50it/s] 64%|██████▎   | 47/74 [00:14<00:06,  3.93it/s] 65%|██████▍   | 48/74 [00:14<00:06,  4.05it/s] 66%|██████▌   | 49/74 [00:15<00:06,  3.60it/s] 68%|██████▊   | 50/74 [00:15<00:07,  3.27it/s] 69%|██████▉   | 51/74 [00:15<00:07,  3.00it/s] 70%|███████   | 52/74 [00:16<00:07,  2.91it/s] 72%|███████▏  | 53/74 [00:16<00:09,  2.23it/s] 73%|███████▎  | 54/74 [00:17<00:07,  2.57it/s] 74%|███████▍  | 55/74 [00:17<00:07,  2.59it/s] 76%|███████▌  | 56/74 [00:18<00:07,  2.55it/s] 77%|███████▋  | 57/74 [00:18<00:07,  2.38it/s] 78%|███████▊  | 58/74 [00:18<00:06,  2.42it/s] 80%|███████▉  | 59/74 [00:19<00:05,  2.51it/s] 81%|████████  | 60/74 [00:19<00:05,  2.69it/s] 82%|████████▏ | 61/74 [00:19<00:04,  3.03it/s] 84%|████████▍ | 62/74 [00:20<00:04,  2.79it/s] 85%|████████▌ | 63/74 [00:20<00:03,  2.92it/s] 86%|████████▋ | 64/74 [00:20<00:03,  2.84it/s] 88%|████████▊ | 65/74 [00:21<00:03,  2.93it/s] 89%|████████▉ | 66/74 [00:21<00:02,  3.09it/s] 91%|█████████ | 67/74 [00:21<00:02,  3.05it/s] 92%|█████████▏| 68/74 [00:22<00:02,  2.96it/s] 93%|█████████▎| 69/74 [00:22<00:01,  2.94it/s] 95%|█████████▍| 70/74 [00:22<00:01,  3.32it/s] 96%|█████████▌| 71/74 [00:23<00:00,  3.38it/s] 97%|█████████▋| 72/74 [00:23<00:00,  2.93it/s] 99%|█████████▊| 73/74 [00:23<00:00,  3.42it/s]100%|██████████| 74/74 [00:23<00:00,  3.90it/s]100%|██████████| 74/74 [00:23<00:00,  3.10it/s]
Stage 2 

Stage 1 history model:
	Train acc 75.3858 Val acc 57.9309 Test acc 55.8072
Stage: 2, threshold 0.75, confident nodes: 59942 / 106818
		 val confident nodes: 36713 / 64879,  val confident level: 0.7440688610076904
		test confident nodes: 23229 / 41939, test confident_level: 0.7212536334991455
Current num label hops = 2
# Params: 12248101
Epoch:20, avg epoch time:29.2575
 Train loss:1.66719088692596, Val loss:1.7036824226379395, Test loss:1.804502010345459
 Train acc:57.1262, Val acc:57.4778, Test acc:55.6284
Best Epoch 17,Val 57.8354, Test 56.1124

Epoch:40, avg epoch time:29.0598
 Train loss:1.4841309820396313, Val loss:1.751666784286499, Test loss:1.8819175958633423
 Train acc:59.2365, Val acc:57.7752, Test acc:56.0433
Best Epoch 34,Val 58.1760, Test 56.2341

Epoch:60, avg epoch time:28.9124
 Train loss:1.3872124976006106, Val loss:1.8320943117141724, Test loss:1.988277792930603
 Train acc:60.6276, Val acc:58.0851, Test acc:56.1506
Best Epoch 56,Val 58.3563, Test 56.3580

Epoch:80, avg epoch time:28.8814
 Train loss:1.3279046321260757, Val loss:1.807083249092102, Test loss:1.9642659425735474
 Train acc:61.5047, Val acc:58.3039, Test acc:56.4010
Best Epoch 62,Val 58.3717, Test 56.3747

Epoch:100, avg epoch time:28.8711
 Train loss:1.2817046504089797, Val loss:1.8965238332748413, Test loss:2.0607550144195557
 Train acc:62.2811, Val acc:58.1051, Test acc:56.2364
Best Epoch 62,Val 58.3717, Test 56.3747

Epoch:120, avg epoch time:28.8169
 Train loss:1.2441504260768061, Val loss:1.9300237894058228, Test loss:2.1127521991729736
 Train acc:62.9270, Val acc:57.9186, Test acc:56.1244
Best Epoch 105,Val 58.4950, Test 56.5798

Epoch:140, avg epoch time:28.7706
 Train loss:1.216310283412104, Val loss:1.9479900598526, Test loss:2.124182939529419
 Train acc:63.4564, Val acc:58.1621, Test acc:56.4200
Best Epoch 105,Val 58.4950, Test 56.5798

Epoch:160, avg epoch time:28.7544
 Train loss:1.1908312068469282, Val loss:1.9792780876159668, Test loss:2.1679272651672363
 Train acc:63.9985, Val acc:58.3841, Test acc:56.5822
Best Epoch 149,Val 58.5274, Test 56.5345

Epoch:180, avg epoch time:28.7151
 Train loss:1.1709129758503125, Val loss:1.9543589353561401, Test loss:2.1380269527435303
 Train acc:64.3381, Val acc:58.0912, Test acc:56.4677
Best Epoch 149,Val 58.5274, Test 56.5345

Epoch:200, avg epoch time:28.7299
 Train loss:1.151317606801572, Val loss:2.0504019260406494, Test loss:2.2403130531311035
 Train acc:64.8065, Val acc:58.0743, Test acc:56.3914
Best Epoch 149,Val 58.5274, Test 56.5345

Epoch:220, avg epoch time:28.5460
 Train loss:1.138079463571742, Val loss:2.028761625289917, Test loss:2.2148008346557617
 Train acc:65.0994, Val acc:58.1267, Test acc:56.4558
Best Epoch 149,Val 58.5274, Test 56.5345

Epoch:240, avg epoch time:28.2926
 Train loss:1.1215023044226826, Val loss:2.0699636936187744, Test loss:2.2636942863464355
 Train acc:65.4603, Val acc:58.2762, Test acc:56.5250
Best Epoch 149,Val 58.5274, Test 56.5345

Best Epoch 149, Val 58.5274, Test 56.5345
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:16,  4.36it/s]  3%|▎         | 2/74 [00:00<00:20,  3.58it/s]  4%|▍         | 3/74 [00:00<00:18,  3.86it/s]  5%|▌         | 4/74 [00:01<00:18,  3.78it/s]  7%|▋         | 5/74 [00:01<00:16,  4.13it/s]  8%|▊         | 6/74 [00:01<00:16,  4.25it/s]  9%|▉         | 7/74 [00:01<00:16,  4.14it/s] 11%|█         | 8/74 [00:02<00:19,  3.40it/s] 12%|█▏        | 9/74 [00:02<00:18,  3.53it/s] 14%|█▎        | 10/74 [00:02<00:18,  3.50it/s] 15%|█▍        | 11/74 [00:03<00:19,  3.30it/s] 16%|█▌        | 12/74 [00:03<00:18,  3.41it/s] 18%|█▊        | 13/74 [00:03<00:17,  3.55it/s] 19%|█▉        | 14/74 [00:03<00:16,  3.63it/s] 20%|██        | 15/74 [00:04<00:17,  3.41it/s] 22%|██▏       | 16/74 [00:04<00:16,  3.48it/s] 23%|██▎       | 17/74 [00:04<00:18,  3.15it/s] 24%|██▍       | 18/74 [00:05<00:15,  3.51it/s] 26%|██▌       | 19/74 [00:05<00:15,  3.66it/s] 27%|██▋       | 20/74 [00:05<00:13,  3.86it/s] 28%|██▊       | 21/74 [00:05<00:13,  4.01it/s] 30%|██▉       | 22/74 [00:05<00:12,  4.17it/s] 31%|███       | 23/74 [00:06<00:12,  4.00it/s] 32%|███▏      | 24/74 [00:06<00:12,  4.10it/s] 34%|███▍      | 25/74 [00:06<00:12,  4.02it/s] 35%|███▌      | 26/74 [00:06<00:11,  4.17it/s] 36%|███▋      | 27/74 [00:07<00:12,  3.80it/s] 38%|███▊      | 28/74 [00:07<00:12,  3.82it/s] 39%|███▉      | 29/74 [00:07<00:11,  3.85it/s] 41%|████      | 30/74 [00:07<00:10,  4.28it/s] 42%|████▏     | 31/74 [00:08<00:10,  4.03it/s] 43%|████▎     | 32/74 [00:08<00:10,  3.97it/s] 45%|████▍     | 33/74 [00:08<00:11,  3.68it/s] 46%|████▌     | 34/74 [00:09<00:10,  3.93it/s] 47%|████▋     | 35/74 [00:09<00:09,  4.05it/s] 49%|████▊     | 36/74 [00:09<00:11,  3.45it/s] 50%|█████     | 37/74 [00:09<00:10,  3.38it/s] 51%|█████▏    | 38/74 [00:10<00:10,  3.32it/s] 53%|█████▎    | 39/74 [00:10<00:11,  3.15it/s] 54%|█████▍    | 40/74 [00:10<00:10,  3.17it/s] 55%|█████▌    | 41/74 [00:11<00:10,  3.07it/s] 57%|█████▋    | 42/74 [00:11<00:10,  2.91it/s] 58%|█████▊    | 43/74 [00:11<00:09,  3.22it/s] 59%|█████▉    | 44/74 [00:12<00:09,  3.13it/s] 61%|██████    | 45/74 [00:12<00:09,  3.13it/s] 62%|██████▏   | 46/74 [00:12<00:09,  2.83it/s] 64%|██████▎   | 47/74 [00:13<00:10,  2.62it/s] 65%|██████▍   | 48/74 [00:13<00:09,  2.81it/s] 66%|██████▌   | 49/74 [00:13<00:07,  3.24it/s] 68%|██████▊   | 50/74 [00:14<00:07,  3.40it/s] 69%|██████▉   | 51/74 [00:14<00:06,  3.72it/s] 70%|███████   | 52/74 [00:14<00:05,  3.71it/s] 72%|███████▏  | 53/74 [00:14<00:04,  4.54it/s] 73%|███████▎  | 54/74 [00:15<00:04,  4.37it/s] 74%|███████▍  | 55/74 [00:15<00:05,  3.45it/s] 76%|███████▌  | 56/74 [00:15<00:05,  3.38it/s] 77%|███████▋  | 57/74 [00:16<00:04,  3.43it/s] 78%|███████▊  | 58/74 [00:16<00:04,  3.45it/s] 80%|███████▉  | 59/74 [00:16<00:04,  3.56it/s] 81%|████████  | 60/74 [00:16<00:03,  3.74it/s] 82%|████████▏ | 61/74 [00:17<00:03,  3.61it/s] 84%|████████▍ | 62/74 [00:17<00:03,  3.41it/s] 85%|████████▌ | 63/74 [00:17<00:03,  3.35it/s] 86%|████████▋ | 64/74 [00:18<00:03,  3.25it/s] 88%|████████▊ | 65/74 [00:18<00:03,  2.87it/s] 89%|████████▉ | 66/74 [00:18<00:02,  2.97it/s] 91%|█████████ | 67/74 [00:19<00:02,  2.99it/s] 92%|█████████▏| 68/74 [00:19<00:01,  3.12it/s] 93%|█████████▎| 69/74 [00:19<00:01,  3.56it/s] 95%|█████████▍| 70/74 [00:19<00:01,  3.99it/s] 96%|█████████▌| 71/74 [00:19<00:00,  4.42it/s] 97%|█████████▋| 72/74 [00:20<00:00,  4.21it/s] 99%|█████████▊| 73/74 [00:20<00:00,  4.57it/s]100%|██████████| 74/74 [00:20<00:00,  3.40it/s]100%|██████████| 74/74 [00:20<00:00,  3.54it/s]
Stage 3 

Stage 2 history model:
	Train acc 70.0499 Val acc 58.5274 Test acc 56.5345
Stage: 3, threshold 0.75, confident nodes: 71523 / 106818
		 val confident nodes: 43321 / 64879,  val confident level: 0.7092633843421936
		test confident nodes: 28202 / 41939, test confident_level: 0.6795971989631653
Current num label hops = 2
# Params: 12248101
Epoch:20, avg epoch time:24.3701
 Train loss:1.7448630668747593, Val loss:1.7758269309997559, Test loss:1.8963842391967773
 Train acc:56.8012, Val acc:57.5363, Test acc:56.1077
Best Epoch 17,Val 57.7321, Test 56.1721

Epoch:40, avg epoch time:24.9485
 Train loss:1.5471902968178333, Val loss:1.8482921123504639, Test loss:2.015232801437378
 Train acc:58.7686, Val acc:57.9248, Test acc:56.1935
Best Epoch 35,Val 58.1945, Test 56.6990

Epoch:60, avg epoch time:25.3291
 Train loss:1.4438011310469936, Val loss:1.9154579639434814, Test loss:2.1027231216430664
 Train acc:59.9672, Val acc:58.2839, Test acc:56.6632
Best Epoch 56,Val 58.2854, Test 56.7491

Epoch:80, avg epoch time:25.2949
 Train loss:1.3824168309359484, Val loss:1.9765846729278564, Test loss:2.1804635524749756
 Train acc:60.8120, Val acc:58.2993, Test acc:56.5059
Best Epoch 79,Val 58.2993, Test 56.5059

Epoch:100, avg epoch time:25.2709
 Train loss:1.3312953005374317, Val loss:2.0292890071868896, Test loss:2.2526071071624756
 Train acc:61.5116, Val acc:58.3440, Test acc:56.6561
Best Epoch 88,Val 58.5135, Test 56.8159

Epoch:120, avg epoch time:25.2381
 Train loss:1.2992164181991361, Val loss:2.1058430671691895, Test loss:2.337477922439575
 Train acc:62.1182, Val acc:58.3609, Test acc:56.7610
Best Epoch 88,Val 58.5135, Test 56.8159

Epoch:140, avg epoch time:25.3293
 Train loss:1.260093606693644, Val loss:2.1075446605682373, Test loss:2.351840019226074
 Train acc:62.6744, Val acc:58.3594, Test acc:56.7515
Best Epoch 138,Val 58.5490, Test 56.9232

Epoch:160, avg epoch time:25.4050
 Train loss:1.2407850597945738, Val loss:2.0714218616485596, Test loss:2.2960073947906494
 Train acc:63.0811, Val acc:58.3764, Test acc:56.6323
Best Epoch 138,Val 58.5490, Test 56.9232

Epoch:180, avg epoch time:25.5106
 Train loss:1.2155727047315785, Val loss:2.1404895782470703, Test loss:2.3846518993377686
 Train acc:63.5358, Val acc:58.3008, Test acc:56.6251
Best Epoch 138,Val 58.5490, Test 56.9232

Epoch:200, avg epoch time:25.5184
 Train loss:1.1976973624296592, Val loss:2.2035679817199707, Test loss:2.4612624645233154
 Train acc:63.8223, Val acc:58.3995, Test acc:56.8087
Best Epoch 138,Val 58.5490, Test 56.9232

Epoch:220, avg epoch time:25.5660
 Train loss:1.1848303851946977, Val loss:2.2415988445281982, Test loss:2.5025391578674316
 Train acc:64.1540, Val acc:58.3764, Test acc:56.8182
Best Epoch 212,Val 58.6261, Test 56.8898

Epoch:240, avg epoch time:25.6035
 Train loss:1.1648828832196518, Val loss:2.2125751972198486, Test loss:2.4652552604675293
 Train acc:64.4472, Val acc:58.4411, Test acc:56.9661
Best Epoch 212,Val 58.6261, Test 56.8898

Epoch:260, avg epoch time:25.5939
 Train loss:1.1560820643330965, Val loss:2.207786798477173, Test loss:2.466187000274658
 Train acc:64.6472, Val acc:58.4904, Test acc:56.8731
Best Epoch 212,Val 58.6261, Test 56.8898

Epoch:280, avg epoch time:25.7240
 Train loss:1.1409094837349905, Val loss:2.1979849338531494, Test loss:2.451378107070923
 Train acc:65.0109, Val acc:58.4827, Test acc:56.8397
Best Epoch 212,Val 58.6261, Test 56.8898

Epoch:300, avg epoch time:25.8915
 Train loss:1.1329380945420602, Val loss:2.211585283279419, Test loss:2.472038745880127
 Train acc:65.1174, Val acc:58.5474, Test acc:56.7896
Best Epoch 290,Val 58.6815, Test 56.8588

Epoch:320, avg epoch time:26.0591
 Train loss:1.1197235785739523, Val loss:2.273813486099243, Test loss:2.529658555984497
 Train acc:65.4805, Val acc:58.4380, Test acc:56.9303
Best Epoch 290,Val 58.6815, Test 56.8588

Epoch:340, avg epoch time:26.2314
 Train loss:1.1089518406021763, Val loss:2.292820692062378, Test loss:2.5636444091796875
 Train acc:65.6690, Val acc:58.4904, Test acc:56.8540
Best Epoch 290,Val 58.6815, Test 56.8588

Epoch:360, avg epoch time:26.3263
 Train loss:1.1018603771505222, Val loss:2.352719306945801, Test loss:2.625797748565674
 Train acc:65.8091, Val acc:58.5613, Test acc:56.7992
Best Epoch 290,Val 58.6815, Test 56.8588

Epoch:380, avg epoch time:26.4260
 Train loss:1.091864179557478, Val loss:2.3168654441833496, Test loss:2.5782785415649414
 Train acc:66.0672, Val acc:58.4935, Test acc:56.7419
Best Epoch 361,Val 58.7463, Test 56.8659

Epoch:400, avg epoch time:26.5331
 Train loss:1.083889042827445, Val loss:2.3681297302246094, Test loss:2.642526626586914
 Train acc:66.2100, Val acc:58.5921, Test acc:56.7515
Best Epoch 361,Val 58.7463, Test 56.8659

Best Epoch 361, Val 58.7463, Test 56.8659
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:16,  4.51it/s]  3%|▎         | 2/74 [00:00<00:23,  3.10it/s]  4%|▍         | 3/74 [00:00<00:21,  3.36it/s]  5%|▌         | 4/74 [00:01<00:24,  2.90it/s]  7%|▋         | 5/74 [00:01<00:24,  2.81it/s]  8%|▊         | 6/74 [00:02<00:24,  2.79it/s]  9%|▉         | 7/74 [00:02<00:21,  3.12it/s] 11%|█         | 8/74 [00:02<00:19,  3.30it/s] 12%|█▏        | 9/74 [00:02<00:20,  3.17it/s] 14%|█▎        | 10/74 [00:03<00:22,  2.81it/s] 15%|█▍        | 11/74 [00:03<00:27,  2.30it/s] 16%|█▌        | 12/74 [00:04<00:24,  2.49it/s] 18%|█▊        | 13/74 [00:04<00:23,  2.65it/s] 19%|█▉        | 14/74 [00:04<00:21,  2.78it/s] 20%|██        | 15/74 [00:05<00:22,  2.62it/s] 22%|██▏       | 16/74 [00:05<00:19,  3.03it/s] 23%|██▎       | 17/74 [00:05<00:17,  3.31it/s] 24%|██▍       | 18/74 [00:05<00:14,  3.87it/s] 26%|██▌       | 19/74 [00:06<00:12,  4.31it/s] 27%|██▋       | 20/74 [00:06<00:12,  4.22it/s] 28%|██▊       | 21/74 [00:06<00:15,  3.35it/s] 30%|██▉       | 22/74 [00:07<00:14,  3.62it/s] 31%|███       | 23/74 [00:07<00:13,  3.92it/s] 32%|███▏      | 24/74 [00:07<00:12,  4.06it/s] 34%|███▍      | 25/74 [00:07<00:12,  3.97it/s] 35%|███▌      | 26/74 [00:07<00:11,  4.18it/s] 36%|███▋      | 27/74 [00:08<00:11,  4.05it/s] 38%|███▊      | 28/74 [00:08<00:12,  3.58it/s] 39%|███▉      | 29/74 [00:08<00:12,  3.69it/s] 41%|████      | 30/74 [00:09<00:15,  2.85it/s] 42%|████▏     | 31/74 [00:09<00:14,  2.95it/s] 43%|████▎     | 32/74 [00:09<00:13,  3.19it/s] 45%|████▍     | 33/74 [00:10<00:11,  3.60it/s] 46%|████▌     | 34/74 [00:10<00:09,  4.23it/s] 47%|████▋     | 35/74 [00:10<00:08,  4.33it/s] 49%|████▊     | 36/74 [00:10<00:08,  4.36it/s] 50%|█████     | 37/74 [00:11<00:09,  3.85it/s] 53%|█████▎    | 39/74 [00:11<00:07,  4.53it/s] 54%|█████▍    | 40/74 [00:11<00:09,  3.57it/s] 55%|█████▌    | 41/74 [00:12<00:09,  3.57it/s] 57%|█████▋    | 42/74 [00:12<00:07,  4.03it/s] 58%|█████▊    | 43/74 [00:12<00:08,  3.67it/s] 59%|█████▉    | 44/74 [00:12<00:08,  3.48it/s] 61%|██████    | 45/74 [00:13<00:08,  3.57it/s] 62%|██████▏   | 46/74 [00:13<00:06,  4.25it/s] 64%|██████▎   | 47/74 [00:13<00:08,  3.28it/s] 65%|██████▍   | 48/74 [00:14<00:08,  3.07it/s] 66%|██████▌   | 49/74 [00:14<00:09,  2.59it/s] 68%|██████▊   | 50/74 [00:15<00:08,  2.72it/s] 69%|██████▉   | 51/74 [00:15<00:08,  2.77it/s] 70%|███████   | 52/74 [00:15<00:07,  2.95it/s] 72%|███████▏  | 53/74 [00:15<00:06,  3.04it/s] 73%|███████▎  | 54/74 [00:16<00:06,  3.33it/s] 74%|███████▍  | 55/74 [00:16<00:05,  3.56it/s] 76%|███████▌  | 56/74 [00:16<00:04,  3.75it/s] 77%|███████▋  | 57/74 [00:16<00:04,  3.74it/s] 78%|███████▊  | 58/74 [00:17<00:04,  3.36it/s] 80%|███████▉  | 59/74 [00:17<00:05,  2.92it/s] 81%|████████  | 60/74 [00:18<00:04,  2.97it/s] 82%|████████▏ | 61/74 [00:18<00:04,  2.88it/s] 84%|████████▍ | 62/74 [00:18<00:04,  2.86it/s] 85%|████████▌ | 63/74 [00:19<00:04,  2.64it/s] 86%|████████▋ | 64/74 [00:19<00:03,  2.90it/s] 88%|████████▊ | 65/74 [00:19<00:03,  2.99it/s] 89%|████████▉ | 66/74 [00:20<00:02,  3.10it/s] 91%|█████████ | 67/74 [00:20<00:02,  2.98it/s] 92%|█████████▏| 68/74 [00:20<00:02,  2.77it/s] 93%|█████████▎| 69/74 [00:21<00:01,  3.21it/s] 95%|█████████▍| 70/74 [00:21<00:01,  3.75it/s] 96%|█████████▌| 71/74 [00:21<00:00,  3.10it/s] 97%|█████████▋| 72/74 [00:22<00:00,  2.75it/s] 99%|█████████▊| 73/74 [00:22<00:00,  3.10it/s]100%|██████████| 74/74 [00:22<00:00,  3.68it/s]100%|██████████| 74/74 [00:22<00:00,  3.28it/s]
